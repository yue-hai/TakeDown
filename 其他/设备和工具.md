# 一、小工具及软件

## 1、图种

1. 将图片和种子（或其他文件）放在同一个目录中
2. 图片重命名为：`1.jpg`
3. 种子重命名为：`2.torrent`
4. 将种子文件压缩，如：`2.rar`
5. 在同目录下创建文本文档，然后在其中输入：`copy/b 1.jpg+2.rar 3.jpg`
6. 将文本文档的后缀名改为：`.bat`
7. 双击 bat 文件。生成的 3.jpg 即为图种
8. 要解压图种只需更改后缀名为 `.rar`，然后解压即可

## 2、N2N V3 安装配置

> N2N 服务端软件 n2n-3.0 下载地址：https://github.com/ntop/n2n/releases/tag/3.0
> 
> N2N 服务端：[n2n-3.0](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fn2n-3.0.zip)
> 
> N2N 客户端软件 EasyN2N 下载地址：https://bugxia.com/357.html
> 
> N2N 客户端：[n2n_client_windows_3.12_Pack_2.zip](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fn2n_client_windows_3.12_Pack_2.zip)

### ①、n2n 简介

1. N2N（Node to Node）是一种点对点（P2P）网络连接协议，用于在网络中直接连接节点（计算机或设备），而无需通过中心服务器。N2N 协议允许网络中的节点之间直接通信，这种直接连接方式可以提供更高的性能和更好的隐私保护。
2. N2N 协议的特点包括：
	1. **点对点连接**：N2N 允许节点之间直接建立连接，无需经过中心服务器，从而减少了网络通信的中间环节，提高了通信效率。
	2. **加密通信**：N2N 支持对通信数据进行加密，保护通信内容的隐私和安全。
	3. **灵活性**：N2N 协议可以在不同的网络环境中使用，包括局域网、广域网和互联网，提供了灵活的网络连接方式。
	4. **开放性**：N2N 是一个开放的协议，可以被集成到各种应用和系统中，为不同的场景提供点对点连接的能力。
3. N2N 协议可以用于构建各种点对点的网络应用，例如直接设备之间的通信、对等网络文件共享、实时音视频通话等。在实际应用中，N2N 协议通常与其他网络技术和安全机制结合使用，以构建更加安全、高效的点对点通信系统。
4. 当然也可以用来改善游戏联机网络

### ②、说明

1. 本次安装配置基于 N2N 的 V3 版本，具体区别请参考：[N2N版本选择介绍（v1\v2\v2s\v3区别\使用方法教程\免费服务器）](https://bugxia.com/n2n_version_intro)
2. 本次配置主要是以 Linux ubuntu 为服务端、Windows 为客户端

### ③、ubuntu 服务端配置

#### Ⅰ、docker 安装服务端

1. 服务端操作系统为：Ubuntu 22.04.3 LTS
2. 开放端口：`10001`、`10002`
	1. `sudo ufw allow from any to any port 10001`
	2. `sudo ufw allow from any to any port 10002`
3. 这里假设 docker 已经安装好了，并且拉取了 ubuntu 的镜像
4. 创建目录：`/home/yan/apply/n2n/n2n/`，下载 N2N 服务端：[n2n-3.0](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fn2n-3.0.zip) 放入其中
5. 解压压缩包：`unzip n2n-3.0.zip`
6. 创建容器，包括后台运行、端口映射、授权等：
	1. 其中，`10001` 是作为 Manage 端口，而 `10002` 作为主要端口
	2. 实测的时候发现 `10002` 端口既需要开放 UDP 也需要开放 TCP

```shell
docker run -itd \
-p 10001:10001/tcp \
-p 10001:10001/udp \
-p 10002:10002/tcp \
-p 10002:10002/udp \
--privileged=true \
-v /home/yan/apply/n2n/n2n/:/home/n2n \
--name ubuntu-n2n-server ubuntu /bin/bash
```

7. 进入该 ubuntu-n2n-server 容器：

```shell
docker exec -it ubuntu-n2n-server /bin/bash
```

8. 更新软件源、安装 vim、安装配置工具：``

```shell
# 更新软件源：
apt-get update

# 安装 vim：
apt-get install -y vim

# 安装配置工具：
apt-get install -y autoconf automake libtool make pkg-config
```

9. 进入 n2n 目录：

```shell
cd /home/n2n
```

10. 依次进行下述每一行命令：

```shell
# 将 autogen.sh 脚本设为可执行
chmod +x autogen.sh

# 执行 autogen.sh 脚本，这个脚本通常负责设置或预处理编译环境，生成配置脚本等
./autogen.sh

# 执行 configure 脚本，这个脚本根据系统环境和用户提供的选项，生成适合当前系统的 Makefile 文件
./configure

# 编译源代码并安装
# 'make' 命令根据前面生成的 Makefile 来编译源代码，生成可执行文件或库文件
# 'make install' 命令则是将编译好的文件安装到指定位置，通常是系统的标准目录下，比如 /usr/local/bin
make && make install
```

11. 创建并编辑配置文件：`vim supernode.conf`，写入下述内容，然后保存退出：

```shell
-t=10001
-p=10002
```

12. 运行 supernode：

```shell
supernode ./supernode.conf
```

13. 检查 supernode 是否在后台运行：

```shell
ps -ef|grep supernode
```

```shell
root@f279e3b2bb3f:/# ps -ef|grep supernode
nobody      1711       1  0 08:34 ?        00:00:00 supernode ./supernode.conf
root        1725    1715  0 08:47 pts/1    00:00:00 grep --color=auto supernode
root@f279e3b2bb3f:/# 
```

14. 根据进程号关闭进程

```shell
kill 1711
```

15. 如果想要确保进程被强制终止，可以使用 kill -9 命令：

```shell
kill -9 1711
```

#### <span id="1-2-3-2">Ⅱ、实体机安装服务端</span>

1. 服务端操作系统为：Ubuntu 22.04.3 LTS
2. 开放端口：`10001`、`10002`
	1. `sudo ufw allow from any to any port 10001`
	2. `sudo ufw allow from any to any port 10002`
3. 使用 root 用户给予 docker 用户 `sudo` 权限

```shell
sudo usermod -aG sudo docker
```

4. 创建目录：`/home/yan/apply/n2n/n2n/`，下载 N2N 服务端：[n2n-3.0](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fn2n-3.0.zip) 放入其中
5. 解压压缩包：`unzip n2n-3.0.zip`
8. 更新软件源、安装 vim、安装配置工具：``

```shell
# 更新软件源：
sudo apt-get update

# 安装 vim：
sudo apt-get install -y vim

# 安装配置工具：
sudo apt-get install -y autoconf automake libtool make pkg-config
```

9. 进入 n2n 目录：

```shell
cd /home/yan/apply/n2n/n2n/
```

10. 依次进行下述每一行命令：

```shell
# 将 autogen.sh 脚本设为可执行
chmod +x autogen.sh

# 执行 autogen.sh 脚本，这个脚本通常负责设置或预处理编译环境，生成配置脚本等
./autogen.sh

# 执行 configure 脚本，这个脚本根据系统环境和用户提供的选项，生成适合当前系统的 Makefile 文件
./configure

# 编译源代码并安装
# 'make' 命令根据前面生成的 Makefile 来编译源代码，生成可执行文件或库文件
# 'make install' 命令则是将编译好的文件安装到指定位置，通常是系统的标准目录下，比如 /usr/local/bin
make && sudo make install
```

11. 创建并编辑配置文件：`vim supernode.conf`，写入下述内容，然后保存退出：

```shell
-t=10001
-p=10002
```

12. 运行 supernode：

```shell
sudo supernode ./supernode.conf
```

13. 检查 supernode 是否在后台运行：

```shell
ps -ef|grep supernode
```

```shell
root@f279e3b2bb3f:/# ps -ef|grep supernode
nobody      1711       1  0 08:34 ?        00:00:00 supernode ./supernode.conf
root        1725    1715  0 08:47 pts/1    00:00:00 grep --color=auto supernode
root@f279e3b2bb3f:/# 
```

#### Ⅲ、查询 n2n edge 节点信息（弃用）

> 1. 使用的服务端脚本是 n2n 服务器自带的，文件在：`/n2n/scripts/n2n-httpd`，直接使用这个也可以
> 2. 下方的脚本和页面等文件需在同一个目录下，且需和 n2n 服务端在同一个设备上
> 3. 开启 10003 端口：sudo ufw allow from any to any port 10003

1. 在 `/home/yan/apply/n2n/` 下创建目录 `n2n-edge-query`
2. 在目录 `n2n-edge-query` 下上传服务端脚本文件：[n2n-edge-query-back.py](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fn2n-edge-query-back.py)
3. 在目录 `n2n-edge-query` 下上传服务端页面文件：[n2n-edge-query-front.html](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fn2n-edge-query-front.html)
4. 在目录 `n2n-edge-query` 下上传服务端页面样式文件：[n2n-edge-query-front-css.css](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fn2n-edge-query-front-css.css)
5. 若是没有安装 `python` 环境，则先安装：`apt install python3`
6. 打开一个 `screen` 终端：

```shell
screen -S n2n-edge-query
```

6. 执行服务端脚本：

```shell
# 进入脚本所在目录
cd /home/yan/apply/n2n/n2n-edge-query/

# 启动脚本
python3 n2n-edge-query-back.py -d >> n2n-edge-query-back.log && echo "" >> n2n-edge-query-back.log
```

7. 按 `Ctrl + a + d` 可退出终端
8. 访问测试：http://ip:10003/

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240523165008.png)

####  Ⅳ、查询 n2n edge 节点信息经常停止的解决（弃用）

1. 创建 `n2n-edge-query-check` 目录用于存放检查接口是否可以访问以及重启后台服务脚本
2. 在其中创建脚本 `check-n2n-edge-query-back.sh` ，用于检查接口是否可以访问

```shell
touch check-n2n-edge-query-back.sh
```

```shell
#!/bin/bash

# API URL
API_URL="http://83.229.120.176:10003"
# 重启【查询 n2n edge 节点信息】后台服务脚本所在路径
restart_path="/home/yan/apply/n2n/n2n-edge-query-check/"

# 分隔符
echo "----------------------------------------------------------------" >> $restart_path/check-n2n-edge-query-back.log
# 换行符
echo "" >> $restart_path/check-n2n-edge-query-back.log

# 尝试访问 API，设置超时时间为 30 秒
if curl --fail --silent --output /dev/null --max-time 30 "$API_URL"; then
    # API 访问成功，保存日志
    echo "【$(date '+%Y-%m-%d %H:%M:%S')】：API 访问成功，不重启【查询 n2n edge 节点信息】后台服务" >> $restart_path/check-n2n-edge-query-back.log
else
    # API 访问失败，重启【查询 n2n edge 节点信息】后台服务
    echo "【$(date '+%Y-%m-%d %H:%M:%S')】：API 访问失败，重启【查询 n2n edge 节点信息】后台服务" >> $restart_path/check-n2n-edge-query-back.log
    # 调用重启脚本
    bash $restart_path/restart-n2n-edge-query-back.sh
fi
```

3. 再创建脚本 `restart-n2n-edge-query-back.sh` ，用于重启后台服务

```shell
touch restart-n2n-edge-query-back.sh
```

```shell
#!/bin/bash

# screen 会话名称，每个会话中可能有多个窗口
screen_name="n2n-edge-query"
# 【查询 n2n edge 节点信息】后台服务所在路径
back_path="/home/yan/apply/n2n/n2n-edge-query/"
# 重启【查询 n2n edge 节点信息】后台服务脚本所在路径
restart_path="/home/yan/apply/n2n/n2n-edge-query-check/"

# 定义发送命令并可选地休眠的函数
# $1 是要发送的命令
# $2 是可选的休眠时间
send_command() {
    # -x：附加到指定的会话。
    # -S $screen_name：指定要操作的会话名称。
    # -p 0：选择会话中的窗口编号，这里是选择窗口编号为 0 的窗口；如果只有一个窗口，那这就是第一个
    # -X stuff：在选定的窗口中发送字符。
    screen -x -S $screen_name -p 0 -X stuff "$1"

    # 如果提供了休眠时间，则进行休眠
    if [ ! -z "$2" ]; then 
        sleep $2
    fi
}

# 模拟按下 Ctrl + C 组合键，防止服务器正在运行；等待 10 秒；执行两次
send_command $'\x03' 20
send_command $'\x03' 5

# 进入服务器目录
send_command "cd $back_path\r" 5

# 发送启动命令，包括运行参数，将命令发送到会话中，并模拟按下回车键
send_command "python3 n2n-edge-query-back.py -d >> n2n-edge-query-back.log && echo "" >> n2n-edge-query-back.log\r"

# 向日志文件中追加日志
echo "【$(date '+%Y-%m-%d %H:%M:%S')】：【查询 n2n edge 节点信息】后台服务已重启" >> $restart_path/check-n2n-edge-query-back.log
```

4. 设置定时执行：
5. 在终端中输入 `crontab -e`，这将打开个人 `crontab` 文件进行编辑
6. 在 `crontab` 文件中添加一行，指定时间和要执行的命令：

```shell
# 检查【查询 n2n edge 节点信息】接口是否可以访问的脚本，每天 8 点执行
0 8 * * * /home/yan/apply/n2n/n2n-edge-query-check/check-n2n-edge-query-back.sh
# 检查【查询 n2n edge 节点信息】接口是否可以访问的脚本，每天 12 点执行
0 12 * * * /home/yan/apply/n2n/n2n-edge-query-check/check-n2n-edge-query-back.sh
# 检查【查询 n2n edge 节点信息】接口是否可以访问的脚本，每天 18 点执行
0 18 * * * /home/yan/apply/n2n/n2n-edge-query-check/check-n2n-edge-query-back.sh
```

#### Ⅴ、查询 n2n edge 节点信息（使用 java 实现）

> 改为使用 java 实现的原因是上面的 py 脚本经常自己停止
> 
> java 工具类：[yuehai-tool-1.0-SNAPSHOT-jar-with-dependencies.jar](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fyuehai-tool-1.0-SNAPSHOT-jar-with-dependencies.jar)

1. linux 中安装 jdk 21 的环境
2. 下载上面的 java 工具类：[yuehai-tool-1.0-SNAPSHOT-jar-with-dependencies.jar](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fyuehai-tool-1.0-SNAPSHOT-jar-with-dependencies.jar)，上传到服务器中
3. 启动 jar：

```shell
nohup java -jar yuehai-tool-1.0-SNAPSHOT-jar-with-dependencies.jar > yuehai-tool.log 2>&1 &
```

4. 访问测试：http://83.229.120.176:10300/static/n2n-edge-query-front.html

### ④、windows 客户端配置

1. 防火墙规则允许 `ipv4\ipv6` 入站：输入快捷键 `windows + x + a` 以<font color="#ff0000">管理员模式</font>打开 powershell，执行下面命令就可以开启 v4 和 v6 的入站规则，出站默认就开启的不需要操作

```shell
netsh advfirewall firewall add rule name= "All ICMP V4" protocol=icmpv4:any,any dir=in action=allow

netsh advfirewall firewall add rule name= "All ICMP V6" protocol=icmpv6:any,any dir=in action=allow
```

2. 下载 EasyN2N 客户端：[n2n_client_windows_3.12_Pack_2.zip](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fn2n_client_windows_3.12_Pack_2.zip)，解压后双击 `n2n.exe` 打开
3. 配置：
	1. 服务器：`服务器ip:10002`
	2. 小组名称：所有人需要是一样的名称
	3. 虚拟网 ip：最好设置为同一网段
	4. 点击启动

![|331](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240315142630.png)

5. 服务器右侧显示绿色对号即为连接成功

![|331](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240315142650.png)

6. 启动后，点击小组名称后的按钮，可打开已连接的主机列表，双击列表项可显示延迟

![|650](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240315143151.png)

### <span id="1-2-5">⑤、linux 客户端配置</span>

1. 服务端操作系统为：Ubuntu 22.04.3 LTS
2. 开放端口：`10001`、`10002`
3. 这里假设 docker 已经安装好了，并且拉取了 ubuntu 的镜像，当然如果不用 docker 也可以选择跳过这一大步
4. 创建目录：`/home/yan/apply/n2n/n2n/`，下载 N2N 服务端：[n2n-3.0](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fn2n-3.0.zip) 放入其中
5. 解压压缩包：`unzip n2n-3.0.zip`
6. 创建容器，包括后台运行、端口映射、授权等：
	1. 其中，`10001` 是作为 Manage 端口，而 `10002` 作为主要端口
	2. 实测的时候发现 `10002` 端口既需要开放 UDP 也需要开放 TCP

```shell
docker run -itd \
-p 10001:10001/tcp \
-p 10001:10001/udp \
-p 10002:10002/tcp \
-p 10002:10002/udp \
--privileged=true \
-v /home/yan/apply/n2n/n2n/:/home/n2n \
--name ubuntu-n2n-client ubuntu /bin/bash
```

7. 进入该 ubuntu-n2n-client 容器：

```shell
docker exec -it ubuntu-n2n-client /bin/bash
```

8. 更新软件源、安装配置工具：

```shell
# 更新软件源：
apt-get update

# 安装配置工具：
apt-get install -y autoconf automake libtool make
```

9. 进入 n2n 目录：

```shell
cd /home/n2n
```

10. 依次进行下述每一行命令：

```shell
# 将 autogen.sh 脚本设为可执行
chmod +x autogen.sh

# 执行 autogen.sh 脚本，这个脚本通常负责设置或预处理编译环境，生成配置脚本等
./autogen.sh

# 执行 configure 脚本，这个脚本根据系统环境和用户提供的选项，生成适合当前系统的 Makefile 文件
./configure

# 编译源代码并安装
# 'make' 命令根据前面生成的 Makefile 来编译源代码，生成可执行文件或库文件
# 'make install' 命令则是将编译好的文件安装到指定位置，通常是系统的标准目录下，比如 /usr/local/bin
make && make install
```

11. 根据上面知道服务器 ip：`101.200.86.248:10002`，和应该加入的小组：`000123`，则启动命令为：

```shell
edge -d n2n0 -c 000123 -a 192.168.1.2 -l 101.200.86.248:10002
```

12. 参数的含义为：
	1. `-d n2n0`：表示创建名为 n2n0 的虚拟网络接口。
	2. `-c 000123`：要加入的网络社区名称。
	3. `-a 192.168.1.2`：分配给虚拟网络接口的 IP 地址。请确保这个地址不会与本地网络冲突。
	4. `-l 101.200.86.248:10002`：指定服务端的 IP 地址和端口。

13. 命令行输出：

```shell
root@a45399aeccce:/home/n2n# edge -d n2n0 -c 000123 -a 192.168.1.2 -l 101.200.86.248:10002
15/Mar/2024 06:29:54 [edge_utils.c:3774] adding supernode = 101.200.86.248:10002
15/Mar/2024 06:29:54 [edge.c:1085] starting n2n edge 3.0.0 Mar 15 2024 06:29:19
15/Mar/2024 06:29:54 [edge.c:1091] using compression: none.
15/Mar/2024 06:29:54 [edge.c:1092] using null cipher.
15/Mar/2024 06:29:54 [edge_utils.c:392] number of supernodes in the list: 1
15/Mar/2024 06:29:54 [edge_utils.c:394] supernode 0 => 101.200.86.248:10002
15/Mar/2024 06:29:54 [edge_utils.c:467] WARNING: encryption is disabled in edge
15/Mar/2024 06:29:54 [edge_utils.c:483] successfully created resolver thread
15/Mar/2024 06:29:54 [edge.c:1116] use manually set IP address
15/Mar/2024 06:29:54 [edge.c:1231] created local tap device IP: 192.168.1.2, Mask: 255.255.255.0, MAC: 52:A0:4F:7C:B6:26
root@a45399aeccce:/home/n2n# 
```

14. 检查 edge 是否在后台运行：

```shell
ps -ef|grep edge
```

```shell
yan@yan:~/apply/game/n2n/n2n$ ps -ef|grep edge
nobody    970705       1  0 12:46 ?        00:00:00 edge -d n2n0 -c 000123 -a 192.168.1.2 -l 127.0.0.1:10002
yan       970897  961863  0 12:48 pts/0    00:00:00 grep --color=auto edge

yan@yan:~/apply/game/n2n/n2n$ 
```

15. 此时在 windows 系统上同时连接上 n2n 客户端，点击小组名称后的按钮，打开已连接的主机列表，发现多了一个客户端，且虚拟 ip 与刚才设置的相同，即为连接成功，双击列表项查看延迟

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240315143151.png)

### ⑥、绕过 UDP 屏蔽

> 如果服务器大陆外或国外，或者是家用网络，有可能会出现 UDP 屏蔽或 QoS
> 
> 下面是一种解决方法：使用 gnb_udp_over_tcp 这个工具，实现将 UDP 数据转换为 TCP 进行传输，绕开 UDP 限制
> 
> github 地址：https://github.com/gnbdev/gnb_udp_over_tcp
> 
> 本地下载：[gnb_udp_over_tcp.zip](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fgnb_udp_over_tcp.zip)

#### Ⅰ、gnb_udp_over_tcp 命令解释

1. udp 转为 tcp；服务端使用，用于将 n2n 的 udp 数据转为 tcp，经由监听的 TCP 端口发出

```shell
gnb_udp_over_tcp -t -l 监听的TCP端口 UDP源地址 UDP源端口
```

2. tcp 转为 udp；客户端使用，用于将接收的服务端发送过来的的 tcp 数据转为 udp，然后转发给本地的 n2n 使用

```shell
gnb_udp_over_tcp -u -l 监听的UDP端口 TCP源地址 TCP源端口
```

#### Ⅱ、ubuntu 服务器配置

1. 服务器开启 `10000` 端口，作为转发端口
2. ubuntu 服务端先正常编译安装 n2n：[ubuntu 实体机安装服务端](#1-2-3-2)
3. 下载上面的 gnb_udp_over_tcp，上传到服务器的 `/home/yan/apply/n2n/` 目录中
4. 解压：

```shell
unzip gnb_udp_over_tcp.zip
```

4. 进入目录 `/home/yan/apply/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/`

```shell
cd /home/yan/apply/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/
```

5. 给予权限：

```shell
chmod 755 gnb_udp_over_tcp
```

6. 创建日志文件：

```shell
touch gnb_udp_over_tcp.log
```

7. 使用 nohup 后台运行：
	1. `-t`：表示启用 TCP 模式，即将 UDP 数据转换为 TCP 数据。
	2. `-l 10000`：`-l` 参数后跟的是监听的 TCP 端口号，这里设置为 10000，表示该服务将监听端口 10000 上的 TCP 连接
	3. `127.0.0.1`：这是 UDP 源地址，这里使用的是本地回环地址（localhost），指的是本机
	4. `10002`：<font color="#ff0000">n2n 使用的端口</font>，即监听的 UDP 源端口，UDP 数据将从这个端口接收

```shell
nohup ./gnb_udp_over_tcp -t -l 10000 127.0.0.1 10002 > /home/yan/apply/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/gnb_udp_over_tcp.log 2>&1 &
```

7. 查看进程的详细信息：

```shell
ps aux | grep gnb_udp_over_tcp
```

```shell
ps aux | grep gnb_udp_over_tcp
yan        56574  1.3  0.0   2940  1624 pts/0    S    08:51   0:01 ./gnb_udp_over_tcp -t -l 10000 127.0.0.1 10002
yan        56680  0.0  0.0   6432   712 pts/0    S+   08:53   0:00 grep --color=auto gnb_udp_over_tcp

yan@yuehai:~/apply/n2n/gnb_udp_over_tcp/bin/Linux_x86_64$ 
```

8. 结束后台进程：

```shell
kill 56574
```

9. 但是这个办法有一个问题，就是长时间运行后，n2n 就无法连接成功了，现在的解决办法是定时重启

#### Ⅲ、ubuntu 服务端定时重启脚本

1. 进入目录 `/home/yan/apply/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/`

```shell
cd /home/yan/apply/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/
```

2. 创建脚本 `restart_process.sh` 和日志文件 `restart_process.log`：

```shell
touch restart_process.sh restart_process.log
```

3. 编写内容：

```shell
#!/bin/bash

# 定义程序路径
file_path="/home/yan/apply/n2n/gnb_udp_over_tcp/bin/Linux_x86_64"

# 杀死现有的后台程序进程
pkill -f 'gnb_udp_over_tcp -t -l 10000'

# 等待几秒确保进程已完全停止
sleep 5

# 添加一个空行
echo "" >> "${file_path}/gnb_udp_over_tcp.log"
# 分隔符
echo "----------------------------------------------------------------" >> "${file_path}/gnb_udp_over_tcp.log"
# 向文件中写入重启时间
echo "【$(date "+%Y-%m-%d %H:%M:%S")】重启完成" >> "${file_path}/gnb_udp_over_tcp.log"

# 重新启动程序
nohup ${file_path}/gnb_udp_over_tcp -t -l 10000 127.0.0.1 10002 >> "${file_path}/gnb_udp_over_tcp.log" 2>&1 &

# 向文件中写入重启时间
echo "【$(date "+%Y-%m-%d %H:%M:%S")】重启完成" >> "${file_path}/restart_process.log"
```

4. 给予权限：

```shell
chmod 755 restart_process.sh
```

5. 设置定时执行：
6. 在终端中输入 `crontab -e`，这将打开个人 `crontab` 文件进行编辑
7. 在 `crontab` 文件中添加一行，指定时间和要执行的命令：

```shell
# 定时重启 gnb_udp_over_tcp，每天每 30 分钟执行一次
*/30 * * * * /home/yan/apply/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/restart_process.sh
```

#### Ⅳ、windows 客户端配置

1. 下载上面的 gnb_udp_over_tcp，解压，进入目录 `bin\Window10_x86_64`
2. 在目录中，按住键盘的 shift 键，选择：在此处打开Powershell 窗口

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240809134147.png)

3. 之后会弹出一个窗口，在其中输入以下内容并回车：
	1. `-u`：表示启用 UDP 模式，即将接收到的 TCP 数据转换为 UDP 数据。
	2. `-l 10002`：<font color="#ff0000">n2n 使用的端口</font>，`-l` 参数后跟的是监听的 UDP 端口号，这里设置为 10002，表示该服务将监听端口 10002 上的 UDP 数据。
	3. `83.229.120.176`：这是 TCP 源地址，即服务端的 IP 地址；<font color="#ff0000">请根据要连接的服务端自行修改这个参数</font>
	4. `10000`：这是服务端监听的 TCP 端口号。

```shell
.\gnb_udp_over_tcp.exe -u -l 10002 83.229.120.176 10000
```

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240809131849.png)

4. 若是不想手动输入上面的命令，也可以直接双击目录的脚本 `run_gnb_udp_over_tcp.bat`，会自动执行该命令

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240809134324.png)

5. 打开 n2n，服务端填写：`127.0.0.1:10002`，点击启动，等待时间会稍长一点，大概六七秒
6. 等待右侧出现绿色对号，即为连接成功

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240809132340.png)

#### Ⅴ、ubuntu 客户端配置

1. ubuntu 客户端先正常编译安装 n2n：[linux 客户端配置](#1-2-5)
3. 下载上面的 gnb_udp_over_tcp，上传到服务器的 `/home/yan/apply/game/n2n/` 目录中
4. 解压：

```shell
unzip gnb_udp_over_tcp.zip
```

4. 进入目录 `/home/yan/apply/game/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/`

```shell
cd /home/yan/apply/game/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/
```

5. 给予权限：

```shell
chmod 755 gnb_udp_over_tcp
```

6. 创建日志文件：

```shell
touch gnb_udp_over_tcp.log
```

7. 使用 nohup 后台运行：
	1. `-t`：表示启用 TCP 模式，即将 UDP 数据转换为 TCP 数据。
	2. `-l 10000`：`-l` 参数后跟的是监听的 TCP 端口号，这里设置为 10000，表示该服务将监听端口 10000 上的 TCP 连接
	3. `127.0.0.1`：这是 UDP 源地址，这里使用的是本地回环地址（localhost），指的是本机
	4. `10002`：<font color="#ff0000">n2n 使用的端口</font>，即监听的 UDP 源端口，UDP 数据将从这个端口接收

```shell
nohup ./gnb_udp_over_tcp -u -l 10002 83.229.120.176 10000 > /home/yan/apply/game/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/gnb_udp_over_tcp.log 2>&1 &
```

7. 查看进程的详细信息：

```shell
ps aux | grep gnb_udp_over_tcp
```

```shell
yan@yan:~/apply/game/n2n/gnb_udp_over_tcp/bin/Linux_x86_64$ ps aux | grep gnb_udp_over_tcp
yan       983515  1.8  0.0   3076  1664 ?        S    15:31   0:09 /home/yan/apply/game/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/gnb_udp_over_tcp -u -l 10002 83.229.120.176 10000
yan       984195  0.0  0.0  17888  2560 pts/0    S+   15:39   0:00 grep --color=auto gnb_udp_over_tcp

yan@yan:~/apply/game/n2n/gnb_udp_over_tcp/bin/Linux_x86_64$ 
```

8. 结束后台进程：

```shell
kill 983515
```

#### Ⅵ、ubuntu 客户端定时重启脚本

1. 进入目录 `/home/yan/apply/game/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/`

```shell
cd /home/yan/apply/game/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/
```

2. 创建脚本 `restart_process.sh` 和日志文件 `restart_process.log`：

```shell
touch restart_process.sh restart_process.log
```

3. 编写内容：

```shell
#!/bin/bash

# 定义文件路径
file_path="/home/yan/apply/game/n2n/gnb_udp_over_tcp/bin/Linux_x86_64"

# 杀死现有的后台程序进程
pkill -f 'gnb_udp_over_tcp -u -l 10002'

# 等待几秒确保进程已完全停止
sleep 5

# 重新启动程序
nohup ${file_path}/gnb_udp_over_tcp -u -l 10002 83.229.120.176 10000 > "${file_path}/gnb_udp_over_tcp.log" 2>&1 &

# 向文件中写入重启时间
echo "【$(date "+%Y-%m-%d %H:%M:%S")】重启完成" >> "${file_path}/restart_process.log"
```

4. 给予权限：

```shell
chmod 755 restart_process.sh
```

5. 设置定时执行：
6. 在终端中输入 `crontab -e`，这将打开个人 `crontab` 文件进行编辑
7. 在 `crontab` 文件中添加一行，指定时间和要执行的命令：

```shell
# 定时重启 gnb_udp_over_tcp，每天每 30 分钟执行一次
*/30 * * * * /home/yan/apply/game/n2n/gnb_udp_over_tcp/bin/Linux_x86_64/restart_process.sh
```

## 3、设备耗电整理

| 设备         | 待机功率/w | 工作功率/w | 单日耗电/度 |
| ---------- | ------ | ------ | ------ |
| 铭凡 UM773   | 14     | 55     | 0.3    |
| 硬盘 - hc330 | 5      | 15     | 0.15   |
| 硬盘柜        |        |        |        |
| 冰箱         | <1     | 84     | 0.76   |
| 空调         | <1     | 980    | 6 ~ 12 |
| 热水器        | <1     | 1800   | 0.6    |

## 4、设备运行的服务整理

### ①、um773

1. java 工具程序：yuehai-tool
2. 多端文件同步程序：syncthing
3. 多硬盘文件同步程序：FreeFileSync

### ②、

### ③、

### ④、

### ⑤、

## 5、

## 6、

# 二、windowd

## 1、系统安装

## 2、用户和密码

### ①、设置账号为空密码

1. 右键我的电脑，选择管理

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023091142.png)

2. 点击计算机管理 -> 系统工具 -> 本地用户和组 -> 用户

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023091703.png)

3. 选择想要设置的用户（比如 yan），右键选择设置密码，弹窗选择继续

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023091806.png)

4. 在弹出的弹窗中，不输入任何内容，直接点击确定

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023091917.png)

5. 完成

### ②、

## 3、用户登录

### ①、开启允许远程桌面

1. 设置中搜索远程，点击显示所有结果

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023083349.png)

2. 在所有结果中，点击远程桌面设置

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023083835.png)

3. 在进入的页面中，点击第一项：接通电源时，让我的电脑保持唤醒状态以进行连接；若是主板支持网络唤醒则不用设置此项，关于网络唤醒之后会说

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023083851.png)

4. 在进入的页面中，将睡眠这一项的选项改为从不；若是主板支持网络唤醒则不用设置此项，关于网络唤醒之后会说

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023083914.png)

5. 点击主页，重新搜索远程，点击显示所有结果，点击远程桌面设置，点击第二项：使我的电脑在专用网络上可被发现，以支持从远程设备进行自动连接；在打开的页面中将下面两项打开

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023083946.png)

6. 点击主页，重新搜索远程，点击：远程桌面休眠设置

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023083535.png)

7. 在进入的页面中，点击第一项：更改设置，以允许通过远程方式连接到此计算机

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023083553.png)

8. 在打开的新页面中，保证上面两个箭头指向的选项被选择，然后点击：选择用户

![|478](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023083620.png)

9. 在打开的新页面中，点击添加，添加想要允许可以进行远程桌面的用户

![|478](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023083702.png)

### ②、允许使用空密码的账号进行远程登录

1. `win + r` ，弹出运行窗口，输入：`secpol.msc`，打开本地安全策略

![|394](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023092257.png)

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023092314.png)

2. 选择安全设置 -> 本地策略 -> 安全选项

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023092411.png)

3. 拉到最后，选中倒数第四个：帐户：使用空密码的本地帐户只允许进行控制台登录

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023092541.png)

4. 双击打开，选择已禁用，点击应用，然后点击确定即可

### ③、本地登录时提示：引用的帐户当前已锁定，且可能无法登录

#### Ⅰ、管理员账户可登录

1. 登录管理员账户
2. 右键点击此电脑，然后点击管理

![|305](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912084203.png)

3. 选择：系统工具 -> 班底用户和组 -> 用户，选择被禁止登录的用户，双击打开

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912084600.png)

4. 将账户已锁定取消勾选，点击应用，然后点击确定即可；我这里显示点不了是因为使用的不是管理员账户，管理员账户没有这个问题

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912084632.png)

5. 重新登录该用户即可

#### Ⅱ、管理员账户不可登录

1.  按住 Shift 键 ，点击右下角电源按钮，然后点击：重启，进入 Windows 高级启动选项界面

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912084936.png)

2. 选择：疑难解答

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912085042.png)

3. 选择：高级选项

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912085053.png)

4. 选择：命令提示符，进入命令提示符界面

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912085102.png)

5. 输入 `net user` 列出当前计算机的所有账户，根据下面的图片可以看到有一个 `Administrator` 账户

```shell
net user
```

6.  然后输入 `net user Administrator /active:yes`激活 `Administrator` 账户
	1. 这条命令的作用是将 `Administrator` 账户设置为活动状态，使其可以登录到Windows系统。
	2. 通常，系统默认情况下，`Administrator` 账户是禁用的，以增加系统的安全性

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912085240.png)

7. 命令执行完成后，关闭命令提示符界面
8. 点击：继续，正常启动计算机后，再次使用正确的密码就可以正常登录了

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912085416.png)

### ④、更改登录尝试失败后的锁定持续时间

1. `Windows + R` 打开运行，输入 `secpol.msc` 后点击确定，打开本地安全策略窗口

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912085926.png)

2. 第一个选项：允许管理员帐户锁定，建议关闭，这样普通用户的账号被锁定后，可以登录管理员账号解锁；<font color="#ff0000">但是这样做最好设置管理员账号禁止远程登录</font>

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240912090217.png)

3. 第三个选项：账户锁定阈值，若是永远不想让账户被锁定，将其改为 0 即可
4. 第二、四个选项根据个人喜好设置

### ⑤、开启电脑网络唤醒

> 这里以华硕主板为例
> 
> wol 唤醒是通过网线将数据传输到主板从而进行唤起计算器，所以是一定要将一根网线连接到电脑，并且使用连接网线的这个网卡上网
> 
> 华硕官方教程：https://www.asus.com.cn/support/faq/1045950/
> 
> 其他的详细教程，整理了一些常见问题：https://post.smzdm.com/p/amx025p4/

#### Ⅰ、查看主板是否支持网络唤醒

1. 网络唤醒是需要硬件支持的，需要满足以下两点（绝大多数现今的电脑都能满足，除非你的电脑真的很老旧）：
	1. 使用支持 ATX 2.01 标准的电源；
	2. 主板需要支持 PCIE 2.2 标准：
2. 在 PCIE 2.2 标准之前，那些旧的主板上会有一个用于网络唤醒的接口（ WAKEUP-LINK header ）需要使用一个特殊的电缆线连接到网卡上才能实现网络唤醒。但是在 PCIE 2.2 标准开始，那些支持此项标准的主板和网卡就不再需要前面所说的网络唤醒电缆线了，因为待机时的电源是通过 PCIE 总线转发的。（参考自 Wiki：[Wake-on-LAN](https://en.wikipedia.org/wiki/Wake-on-LAN#Hardware_requirements)）
3. 也就是说，如果你设置了网络唤醒，你的电脑在睡眠（S3）、休眠（S4）或关机（S5）时，你的网卡还是会处于待机状态，那么此时网卡待机时所需要的电源就是由 PCIE 总线转发的。
4. 不同的主板对网卡待机的电源策略不同，并不是所有主板都支持网卡在睡眠（S3）、休眠（S4）或关机（S5）时处于待机（Standby）状态。
5. 因此我们在 BIOS 中查找 WOL 有关的设置时，往往需要到电源的相关选项中去寻找关于 WOL 的选项，其中的关键词有（参考自[少数派文章](https://sspai.com/post/67003)）：
	1. ACPI 
	2. PCIE 设备开机
	3. Automatic Power On
	4. Wake on LAN/WLAN
	5. Power Management
	6. Power On by Onboard LAN
	7. Power On by PCI-E Devices
	8. ......
6. 关于具体的主板型号，请自行百度了解，或者询问卖家客服

#### Ⅱ、主板 BIOS 设置

1. 开机按住 F2 或者 <font color="#ff0000">DEL</font> 进入 bios，这是针对华硕主板，其它主板可以自行百度。
2. 切换语言-简体中文，进入高级设置（Advanced），找到：高级电源管理设置（APM Configuration）

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918133750.png)

3. 将 PCI-E 设备唤醒（Power On By PCI-E），设置为启用：Enabled

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918133933.png)

4. 保存退出，操作完成后计算机会自动开机，等待 2 秒开机。

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918134001.png)

5. 至此主板 BIOS 设置完毕，继续进行下面的设置

#### Ⅲ、网卡设置

1. 右键我的电脑，选择管理

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918134318.png)

2. 找到网络设配器，找到自己的网卡，网卡是和 cpu 关联，一般是在最上面的，切记别选中带有 wifi 字样的，wol 唤醒是通过网线将数据传输到主板从而进行唤起计算器，所以要找到有线网络的网卡

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918134452.png)

3. 双击网卡打开属性面板，进入高级设置，找到唤醒魔包，将其启用

![|461](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918134947.png)

4. 再选择电源管理设置，勾选：允许这个装置唤醒计算机

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918135036.png)

#### Ⅳ、关闭快速启动功能

1. 鼠标右键点击 Windows 开始菜单 ，并选择：电源选项

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918135400.png)

2. 在弹出来的设置页面中选择：其他电源设置

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918135509.png)

3. 在弹出来的控制面板页面中选择：选择电源按钮的功能

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918135654.png)

4. 在新的控制面板页面中，先点击：更改当前不可用的设置，然后<font color="#ff0000">取消勾选：启用快速启动</font>

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918135801.png)

5. <font color="#ff0000">点击保存更改</font>

#### Ⅴ、查看本机 mac 地址、ipv4 地址

1. 右键开始菜单，选择运行，输入：cmd，打开命令行工具

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918140126.png)

2. 输入：`ipconfig/all` 查看本机相关网络参数，记录下网卡对应的物理地址（mac 地址）和 ipv4 地址，<font color="#ff0000">端口默认为 9</font>

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240918140544.png)

#### Ⅵ、网络唤醒

> 需要设置都在同一个局域网才可以进行网络唤醒

1. 输入 mac 地址、ip 地址、端口号即可，可以使用下面的工具
2. 使用网站：https://www.depicus.com/wake-on-lan/woli
3. 或者 app：[WakeOnLan.apk](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FWakeOnLan.apk)
4. 或者自己实现代码：

```java
package com.yuehai.tool.tool;

import java.io.IOException;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;

/**
 * Wake-on-LAN 工具类
 *
 * @author 月海
 * @date 2024/3/15 13:28
 * @description 使用 Wake-on-LAN 唤醒局域网内的电脑
 */
public class WakeOnLan {
    
    /**
     * 启动 Wake-on-LAN
     *
     * @throws IOException 发送数据包时可能抛出的异常
     */
    public void startWakeOnLan(String mac, String ip, int port) throws IOException {
        // 尝试发送魔术包
        wakeup(mac, ip, port);
    }
    
    /**
     * 发送魔术包以唤醒指定的设备
     *
     * @param mac 目标设备的 MAC 地址
     * @param ip 广播地址
     * @param port 端口号
     */
    private void wakeup(String mac, String ip, int port) throws IOException {
        // 将 MAC 地址字符串转换为 byte 数组
        byte[] macBytes = getMacBytes(mac);
        // 创建 byte 数组用于存放魔术包数据，6 个字节的广播地址 + 16 倍的 MAC 地址
        byte[] bytes = new byte[6 + 16 * macBytes.length];
        // 填充魔术包前 6 个字节为 0xFF，这是 Wake-on-LAN 协议规定的格式
        for (int i = 0; i < 6; i++) {
            bytes[i] = (byte) 0xff;
        }
        // 将 MAC 地址重复 16 次添加到魔术包数据中
        for (int i = 6; i < bytes.length; i += macBytes.length) {
            System.arraycopy(macBytes, 0, bytes, i, macBytes.length);
        }
        
        // 根据提供的 IP 地址创建 InetAddress 对象，这里可能会将域名解析为 IP 地址
        InetAddress address = InetAddress.getByName(ip);
        /*
            创建 DatagramSocket 对象用于发送数据包，这里不指定端口表示由系统随机分配端口
            使用 try-with-resources 语法，确保 DatagramSocket 资源在使用后自动关闭
         */
        try (DatagramSocket socket = new DatagramSocket()) {
            // 创建 DatagramPacket 对象，包含要发送的数据、长度、目标地址和端口
            DatagramPacket packet = new DatagramPacket(bytes, bytes.length, address, port);
            // 通过 DatagramSocket 发送数据包
            socket.send(packet);
        }
    }
    
    /**
     * 将 MAC 地址字符串转换为 byte 数组
     *
     * @param macStr MAC 地址字符串
     * @return MAC 地址的 byte 数组形式
     */
    private byte[] getMacBytes(String macStr) throws IllegalArgumentException {
        // 创建一个长度为 6 的 byte 数组，用于存储 MAC 地址的二进制形式
        byte[] bytes = new byte[6];
        // 将 MAC 地址字符串按照冒号或短横线分割成字符串数组
        String[] hex = macStr.split("([:\\-])");
        // 如果分割后的数组长度不等于 6，说明 MAC 地址格式不正确，抛出异常
        if (hex.length != 6) {
            throw new IllegalArgumentException("无效的 MAC 地址");
        }
        // 循环将每个十六进制字符串转换为 byte 值，存储到 byte 数组中
        try {
            for (int i = 0; i < 6; i++) {
                bytes[i] = (byte) Integer.parseInt(hex[i], 16);
            }
        } catch (NumberFormatException e) {
            // 如果转换过程中出现异常，表示 MAC 地址中包含非十六进制字符，抛出异常
            throw new IllegalArgumentException("解析 MAC 地址出错", e);
        }
        
        // 返回转换后的 MAC 地址 byte 数组
        return bytes;
    }
}
```

### ⑥、

## 4、端口设置

### ①、查看指定进程的端口号

1. 打开任务管理器，选择详细信息，我们这次查看 QQ 的端口号，可以看到 PID 为 `8020`

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231222101725.png)

2. 根据这个 PID 来查询其信息：`netstat -ano | find "8028"`

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231222102248.png)

3. 其中第二列就是 QQ 这个进程使用的所有的端口号

### ②、

## 5、系统设置

### ①、开机时默认启开小键盘（数字键盘）

1. 首先按 `win+R` 启动打开 `运行` ，弹出运行窗口后输入 `regedit`  按 `确定` 
2. 之后会弹出注册表编辑器，在这里我们打开：`计算机\HKEY_USERS\.DEFAULT\Control Panel\Keyboard`
3. 打开它后双击打开 `InitialKeyboardIndicators`，默认数值是 `2147483648`
4. 弹出编辑字符串，在数值数据中输入 `2`，单击确定；在这里 2 的意思是“默认启开小键盘

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240530124920.png)

5. 设置完成后重启电脑即可

### ②、设置软件开机自启

1. 按 Win+R 打开运行窗口，输入 `shell:startup`，然后按回车，会打开一个目录
2. 将软件的快捷方式放入此目录即可

### ③、语言设置已经是中文，但设置内仍是英文

1. 打开控制面板
2. 选择：`控制面板\时钟和区域`，点击：更改日期、时间或数字格式

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240530125212.png)

3. 在弹窗中点击管理，然后点击：更改系统区域设置

![|461](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240530125309.png)

4. 在当前系统区域设置中，选择：**中文(简体，中国)**

![|415](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240530125432.png)

5. 点击确定，重启即可

### ④、某些软件显示字符为乱码

1. 打开控制面板
2. 选择：`控制面板\时钟和区域`，点击：更改日期、时间或数字格式

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240530125212.png)

3. 在弹窗中点击管理，然后点击：更改系统区域设置

![|461](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240530125309.png)

4. 在当前系统区域设置中，选择：**中文(简体，中国)**

![|415](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240530125432.png)

5. 查看下方的 `Beta 版` 是否勾选，若是勾选则`取消勾选`

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240530125558.png)

6. 点击确定，重启即可

### ⑤、

## 6、问题记录

### ①、Win10 系统下任务栏图标显示白色方块变成空白的解决方法

1. 按快捷键 `Win+R` 打开 cmd 命令行，输入 `%localappdata%`，回车，进入 `C:\Users\10222148\AppData\Local` 目录
2. 在打开的文件夹中，找到 `Iconcache.db`，将其删除。（如果找不到 `Iconcache.db` 文件，说明被系统隐藏了，在文件夹选项中，查看的选项卡，点击“显示隐藏的文件、文件夹和驱动器”即可）
3. 打开 `任务管理器`，在任务管理器中找到 `Windows资源管理器`，右击鼠标，选择 `重新启动` 即可重建图标缓存。

### ②、win10 企业版 LTSC 激活方法

1. win+R 输入 PowerShell 打开 PowerShell 管理员版本
2. 逐条输入以下代码：

```shell
# 安装产品密钥
# 此命令使用 slmgr 脚本（Windows 软件许可管理工具）来安装指定的产品密钥
slmgr -ipk M7XTQ-FN8P6-TTKYV-9D4CC-J462D

# 设置密钥管理服务(KMS)服务器地址
# slmgr -skms 命令用于指定 KMS 服务的地址，用于激活 Windows
slmgr -skms kms.03k.org

# 激活 Windows
# slmgr -ato 命令触发操作系统使用先前安装的密钥和配置的 KMS 服务器进行在线激活
slmgr -ato

# 显示许可信息
# slmgr -dlv 命令用于显示详细的许可信息，包括激活状态和许可证类型
slmgr -dlv
```

### ③、延长 windows 系统暂停更新时间

1. 按下 `Win + R` 组合键，打开运行，然后输入 `regedit` 命令，再按回车，打开注册表编辑器

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240820090204.png)

2. 注册表编辑器窗口，依次展开到以下路径：`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings`

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240820090327.png)

3. 在 `Settings` 右侧空白处，点击右键，选择：新建 -> DWORD(32 位)值(D)

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240820090429.png)

4. 新建的 DWORD(32 位)值(D) 命名为 `FlightSettingsMaxPauseDays`

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240820090540.png)

5. 双击打开 `FlightSettingsMaxPauseDays` 编辑窗口，基数选择十进制，数值数据输入你想暂停更新的的天数，比如设置 3000 天，再点击确定

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240820090708.png)

6. `Win+I` 快捷键打开设置，选择：更新和安全 -> Windows 更新 -> 高级选项，设置暂停更新的截止日期

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240820090858.png)

### ④、

### ⑤、

### ⑥、

## 7、软件使用

### ①、SubtitleEdit 字幕处理

#### Ⅰ、语音识别 Whisper 设置为简体中文

1. 点击视频 -> 语音识别 Whisper

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240107201712.png)

2. 点击高级

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240107201738.png)

3. 在弹出的页面中添加参数：`--initial_prompt 以下是普通话的句子`

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240107201850.png)

4. 点击确定即可

#### Ⅱ、Whisper 和 Vosk/Kaldi 的区别

##### （1）、Whisper

1. 开发者：Whisper 是由 OpenAI 开发的一个语音识别模型
2. 技术基础：Whisper 使用了深度学习模型，特别是基于 Transformer 架构的模型。它可以处理多种语言，并且在噪音较大的环境下也能保持较高的准确率
3. 准确性：Whisper 通常能够提供非常高的语音识别准确性，特别是在处理多语言和口音时表现突出
4. 硬件要求：由于 Whisper 是一个深度学习模型，它对硬件的要求较高，尤其是在本地运行时，通常需要强大的 GPU 支持
5. 适用场景：Whisper 适合用于需要高准确度和多语言支持的项目，特别是在有较大计算资源的情况下

##### （2）、Vosk/Kaldi

1. 开发者：Kaldi 是一个开源的语音识别工具包，广泛应用于学术界和工业界；Vosk 是基于 Kaldi 的一个轻量级语音识别库
2. 技术基础：Kaldi 使用的是传统的语音识别技术，结合了统计模型和深度学习的方法。Vosk 作为 Kaldi 的衍生项目，专注于提供易于使用的接口
3. 准确性：Vosk/Kaldi 的准确性通常依赖于具体的模型和训练数据。虽然它们的准确性可能不如 Whisper 在复杂场景中的表现，但在特定任务中仍然非常可靠
4. 硬件要求：与 Whisper 相比，Vosk/Kaldi 对硬件的要求较低，可以在普通的 CPU 上运行，非常适合嵌入式系统或资源受限的环境
5. 适用场景：Vosk/Kaldi 适合用于资源受限的场景或不需要极高精度的应用，如嵌入式设备、实时处理等

##### （3）、总结

1. 如果有强大的硬件资源，并且需要处理多语言或噪音较大的音频，那么 Whisper 是更好的选择
2. 如果资源有限，或是在嵌入式系统中应用，Vosk/Kaldi 会是更合适的选择

#### Ⅲ、b 站上传时提示字幕格式不正确

> 原因：有空行，即时间下面的一行应该跟着字幕内容，但是此处却为空

1. 将字幕内容复制到 word
2. 点击查找，然后点击特殊格式
3. 查找一个任意数字和三个段落标记：

![|700](软件使用/attachments/Pasted%20image%2020240315100518.png)

4. 符号表示为：`^#^p^p^p`

![|312](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240315100600.png)

5. 找到空行后，可以添加空格，也可以直接删掉时间

#### Ⅳ、

### ②、查看及导出目录结构

#### Ⅰ、查看目录结构

1. 目录窗口视图

![|675](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240511090819.png)

2. 查看目录结构（文件夹）：在当前要操作的文件夹目录下输入命令 `tree`，此时得到目录下树形的目录结构。默认情况下只显示“文件夹”而不显示文件。

```shell
tree
```

![|474](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240511091131.png)

3. 查看目录结构（包括文件）：使用参数 `/f` 将以层次的结构显示所有文件夹及文件的名称。

```shell
tree /f
```

![|481](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240511091256.png)

#### Ⅱ、导出目录结构

> 将当前文件夹树形结构写入 xxx.txt 中

1. 保存的树形结构，只含有文件夹

```shell
tree /f > darknet.txt
```

2. 保存的树形结构，包含文件夹和文件

```shell
tree /f > darknetf.txt
```

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240511092214.png)

### ③、大小写锁定提示

1. 在微软商店中搜索：`ModernFlyouts`
2. 或进入官网：https://modernflyouts-community.github.io/

![|600](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240902150244.png)

3. 安装完毕后，打开软件，点击锁定键浮出控件模块，启动即可

![|600](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240902150435.png)

### ④、

### ⑤、

### ⑥、

## 8、

# 三、Ubuntu

## 1、系统安装

1. 桌面版镜像下载：https://cn.ubuntu.com/download/desktop
2. 可使用 rufus 创建启动盘：https://rufus.ie/zh/
3. 在 bios 中选择从启动盘打开，但是有的 bios 需要关闭安全启动；一般是 boot 选项下的 `Secure Boot` 选项，修改为 `Disabled` 禁用
4. 在 bios 选择从启动盘打开后，选择第一项：`Try or Install Ubuntu`，然后按回车

![|655](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225150729.png)

5. 在下一个屏幕中，单击 `Install Ubuntu`

![|655](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225150824.png)

6. 选择喜欢的键盘布局，然后单击下一步

![|655](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225150914.png)

7. 在这一步中，我们必须选择安装类型。有两个选项，普通安装和最小安装，然后单击下一步
	1. 在普通安装中，将安装所有 GUI 相关的应用程序，
	2. 在最小安装中只会安装基本的应用程序。

![|655](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225151000.png)

8. 在这一步中，将提示我们选择安装类型。这里的安装类型指的是分区方案。以下是两种安装类型
	1. `Erase Disk and Install Ubuntu`：它将删除整个磁盘，并将自动创建分区。
	2. `Something else`：创建自定义分区方案。如果是 Ubuntu Linux 的新手，那么建议选择第一个选项

![|655](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225151211.png)

9. 根据当前的地区选择位置，它将相应地配置时区。

![|655](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225151259.png)

10. 创建用户并设置主机名；在此步骤中，指定本地用户名及其密码，指定系统的主机名。我们会在安装系统后使用该用户。

![|655](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225151331.png)

11. 接下来根据提示重启即登录即可

## 2、用户和密码

### ①、新安装的系统修改 root 密码

1. ubuntu 默认的 root 用户是没有固定密码的，它的密码是随机产生并且动态改变的，即每次开机都有一个新的 root 密码，如果想查看 root 密码，那么直接设置的 root 密码即可。
2. 使用安装时候的用户登录进入终端，在终端输入命令：`sudo passwd root`
3.  会显示以下内容，根据内容输入

```shell
[sudo] password for kerwin: # 输入当前用户密码
New password: # 输入root 新密码
Retype new password: # 再次输入 root 密码
passwd: password updated successfully # 密码更新成功
```

4. root 密码设置完成了，输入：`su root`
5. 切换到 root 用户，能切换到证明修改成功

### ②、Ubuntu 下创建新用户

#### Ⅰ、`adduer`

- 对应着删除用户的命令：`deluser`

1. 会自动为创建的用户指定主目录、系统 shell 版本，会在创建时输入用户密码，使用：

```shell
sudo adduser 新用户名
```

2. 默认情况下：
   1. `adduser` 在创建用户时会主动调用 `/etc/adduser.conf`
   2. 在创建用户主目录时默认在 `/home` 下，而且创建为 `/home/用户名`
   3. 如果主目录已经存在，就不再创建，但是此主目录虽然作为新用户的主目录，而且默认登录时会进入这个目录下，但是这个目录并不是属于新用户，当使用 `userdel` 删除新用户时，并不会删除这个主目录，因为这个主目录在创建前已经存在且并不属于这个用户。
   4. 为用户指定 shell 版本为：`/bin/bash`
4. 常用参数选项为：
   1. `–home`： 指定创建主目录的路径，默认是在 /home 目录下创建用户名同名的目录，这里可以指定；如果主目录同名目录存在，则不再创建，仅在登录时进入主目录。
   2. `–quiet`： 即只打印警告和错误信息，忽略其他信息。
   3. `–debug`： 定位错误信息。
   4. `–conf`： 在创建用户时使用指定的configuration文件。
   5. `–force-badname`： 默认在创建用户时会进行/etc/adduser.conf中的正则表达式检查用户名是否合法，如果想使用弱检查，则使用这个选项，如果不想检查，可以将/etc/adduser.conf中相关选项屏蔽。如：

![](./attachments/Pasted%20image%2020230725150747.png)

#### Ⅱ、`useradd`

- 对应着删除用户的命令：`userdel`

1. 需要使用参数选项指定基本设置，如果不使用任何参数，则创建的用户无密码、无主目录、没有指定 shell 版本，使用：

```shell
sudo useradd 新用户名
```

2. 为用户指定登录密码：

```shell
sudo passwd 上面新建的用户名
```

4. 为用户指定命令解释程序(通常为/bin/bash)：

```shell
sudo usermod -s /bin/bash 上面新建的用户名
```

5. 为用户指定用户主目录：

```shell
sudo usermod -d /home/tt 上面新建的用户名
```

6. 常用为用户指定参数的 useradd 命令：
   1. `-d`： 指定用户的主目录
   2. `-m`： 如果存在不再创建，但是此目录并不属于新创建用户；如果主目录不存在，则强制创建； -m和-d一块使用。
   3. `-s`： 指定用户登录时的shell版本
   4. `-M`： 不创建主目录

### ③、给予普通用户 `sudo` 权限

- 使用 root 用户或者拥有 `sudo` 权限的用户执行下面的命令

```shell
sudo usermod -aG sudo 普通用户的用户名
```

### ④、修改用户密码

#### Ⅰ、修改当前用户的密码

1. 打开终端，然后输入以下命令：

```shell
passwd
```

2. 系统会提示输入当前的密码（如果有的话），然后输入新密码并进行确认。

#### Ⅱ、修改其他用户的密码

1. 如果是管理员或有 sudo 权限，可以为其他用户设置密码。打开终端，然后使用以下命令：

```shell
sudo passwd 用户名
```

2. 将“用户名”替换为想要修改密码的用户名。系统将提示输入新的密码。

#### Ⅲ、在无法登录的情况下重置密码（恢复模式）

1. 如果无法登录，可以通过 Ubuntu 的恢复模式重置密码：
2. 重新启动的电脑。
3. 在启动时，按住 Shift 键（在一些系统上可能是 Esc 或其他键），以便进入 GRUB 菜单。
4. 选择 “高级选项” 并进入“恢复模式”。
5. 选择 “root” 以进入根终端。
6. 如果文件系统是只读的，运行 `mount -o remount,rw /` 来使其可写。
7. 使用 passwd 用户名 命令来设置新密码。
8. 重启系统。

### ⑤、更改文件所有者

1. 查看文件列表，发现此时 `privkey1.pem` 的所有者是 root

```shell
yan@yuehai:~/apply/yuehai-tool/https_certificate$ ll
total 24
drwxr-xr-x 2 yan  yan  4096 Aug 30 13:41 ./
drwxr-xr-x 4 yan  yan  4096 Aug 30 13:40 ../
-rw-r--r-- 1 yan  yan  1773 Aug 30 13:39 cert1.pem
-rw-r--r-- 1 yan  yan  1801 Aug 30 13:39 chain1.pem
-rw-r--r-- 1 yan  yan  3574 Aug 30 13:39 fullchain1.pem
-rw------- 1 root root 1704 Aug 30 13:41 privkey1.pem
yan@yuehai:~/apply/yuehai-tool/https_certificate$
```

2. 使用 `chown` 命令更改文件所有者为 yan

```shell
sudo chown yan:yan privkey1.pem
```

3. 再次查看文件列表，发现文件只有执行权限

```shell
yan@yuehai:~/apply/yuehai-tool/https_certificate$ ll
total 28
drwxr-xr-x 2 yan yan 4096 Aug 30 13:46 ./
drwxr-xr-x 4 yan yan 4096 Aug 30 13:40 ../
-rw-r--r-- 1 yan yan 1773 Aug 30 13:39 cert1.pem
-rw-r--r-- 1 yan yan 1801 Aug 30 13:39 chain1.pem
-rw-r--r-- 1 yan yan  124 Aug 30 13:43 config.json
-rw-r--r-- 1 yan yan 3574 Aug 30 13:39 fullchain1.pem
-rw------- 1 yan yan 1704 Aug 30 13:41 privkey1.pem
yan@yuehai:~/apply/yuehai-tool/https_certificate$ 
```

4. 修改权限为 `644`：

```shell
chmod 644 privkey1.pem
```

5. 再次查看文件列表

```shell
yan@yuehai:~/apply/yuehai-tool/https_certificate$ ll
total 28
drwxr-xr-x 2 yan yan 4096 Aug 30 13:46 ./
drwxr-xr-x 4 yan yan 4096 Aug 30 13:40 ../
-rw-r--r-- 1 yan yan 1773 Aug 30 13:39 cert1.pem
-rw-r--r-- 1 yan yan 1801 Aug 30 13:39 chain1.pem
-rw-r--r-- 1 yan yan  124 Aug 30 13:43 config.json
-rw-r--r-- 1 yan yan 3574 Aug 30 13:39 fullchain1.pem
-rw-r--r-- 1 yan yan 1704 Aug 30 13:41 privkey1.pem
yan@yuehai:~/apply/yuehai-tool/https_certificate$ 
```

### ⑥、

### ⑦、

## 3、用户登录

### ①、启用 SSH

1. 更新软件源

```shell
sudo apt update
```

2. 安装 `openssh-server` 软件包：

```shell
sudo apt install openssh-server
```

3. 当被提示时，输入密码并且按 Enter，继续安装。
4. 一旦安装完成之后，SSH 服务将会被自动启动。可以验证 SSH 是否正在运行，输入：

```shell
sudo systemctl status ssh
```

5. 如果输出内容和下文一样，则表示服务正在运行，并且启用开机启动。

```shell
yan@yan:~/桌面/clash$ sudo systemctl status ssh
[sudo] yan 的密码： 
● ssh.service - OpenBSD Secure Shell server
     Loaded: loaded (/lib/systemd/system/ssh.service; enabled; vendor preset: e>
     Active: active (running) since Mon 2023-12-25 20:23:59 CST; 13h ago
       Docs: man:sshd(8)
             man:sshd_config(5)
   Main PID: 724 (sshd)
      Tasks: 1 (limit: 35682)
     Memory: 3.4M
        CPU: 198ms
     CGroup: /system.slice/ssh.service
             └─724 "sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups"

12月 25 20:23:59 yan sshd[724]: Server listening on :: port 22.
12月 25 20:23:59 yan systemd[1]: Started OpenBSD Secure Shell server.
12月 25 20:27:58 yan sshd[2644]: Accepted password for yan from 192.168.31.1 po>
12月 25 20:27:58 yan sshd[2644]: pam_unix(sshd:session): session opened for use>
12月 25 20:32:55 yan sshd[3831]: Accepted password for yan from 192.168.31.1 po>
12月 25 20:32:55 yan sshd[3831]: pam_unix(sshd:session): session opened for use>
12月 25 20:34:43 yan sshd[3881]: Accepted password for yan from 192.168.31.1 po>
12月 25 20:34:43 yan sshd[3881]: pam_unix(sshd:session): session opened for use>
12月 26 01:43:59 yan sshd[6097]: Connection closed by 207.90.244.6 port 58230 [>
12月 26 01:44:01 yan sshd[6099]: Connection closed by 207.90.244.6 port 58238 [>
lines 1-22/22 (END)
```

### ②、开启 ssh 可以使用 root 用户登录

1. 已经安装了 `openssh-server` 软件包，启用了 SSH
2. 修改配置文件 `/etc/ssh/sshd_config`：

```shell
# 编辑或创建文件
sudo nano /etc/ssh/sshd_config

# 将：
# PermitRootLogin prohibit-password

# 改成
PermitRootLogin yes
```

3. 重启服务：`sudo systemctl restart ssh`

### ③、开启桌面可以使用 root 用户登录

1. 在设置完 root 用户的密码之后
2. 注释这两个文件的对应代码 `/etc/pam.d/gdm-autologin`、`/etc/pam.d/gdm-password`：

```shell
# 需要注释掉的代码
auth required pam_succeed_if.so user != root quiet_success

# 编辑或创建文件
# 此文件负责配置 GDM 无密码自动登录的认证过程。
# 它定义了在用户尝试通过 GDM 自动登录（无需输入密码）时所应用的 PAM 认证规则和模块。
# 配置可能包括一系列的 PAM 模块，用于检查用户的登录权限、记录登录尝试、设置用户环境等。
# 修改此文件可以改变自动登录的行为，比如添加额外的安全检查或者限制哪些用户可以自动登录。
sudo nano /etc/pam.d/gdm-autologin

# 编辑或创建文件
# 与 /etc/pam.d/gdm-autologin 相对，这个文件配置的是通过 GDM 使用密码登录时的认证过程。
# 它指定了用户在 GDM 登录界面输入密码尝试登录时所需遵循的 PAM 规则和使用的模块。
# 这些规则和模块可能涉及密码验证、账户和密码的有效期检查、用户登录限制等。
# 修改此文件可以用于增强登录过程的安全性，例如通过增加双因素认证、限制登录尝试次数等方式。
sudo nano /etc/pam.d/gdm-password
```

3. 修改 `/root/.profile` 文件：``

```shell
# 该配置文件专门用于 root 用户的 shell 环境设置。
# 当 root 用户登录到系统或启动一个新的 shell 会话时，这个文件被自动读取和执行。
sudo nano /root/.profile

# 注释掉或者删除行
mesg n 2＞ /dev/null || true

# 插入新行
tty -s && mesg n || true
```

4. 测试：注销当前用户后在登录界面选择“未列出”，然后输入用户名和密码登录，如下图所示：

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231226102848.png)

### ④、通过 Windows 远程桌面连接 Ubuntu 桌面

#### Ⅰ、Ubuntu 中安装 xrdp

1. 更新软件源

```shell
sudo apt update
```

2. 在 Ubuntu 系统中安装远程桌面协议(Remote Desktop Protocol，RDP) 服务器程序 xrdp：

```shell
sudo apt install xrdp
```

3. 安装完成后启动 xrdp 程序：

```shell
sudo systemctl enable --now xrdp
```

4. 再执行下面的命令打开防火墙端口 3389

```shell
sudo ufw allow from any to any port 3389 proto tcp
```

5. 以上就是 Ubuntu 系统中的所有操作。

#### Ⅱ、Windows 系统远程桌面连接

1. 在 Windows 系统中，首先点击搜索框，然后输入关键字 `remote`，再在搜索结果中点击“远程桌面连接”应用。

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225153003.png)

2. 在弹出的远程桌面连接的窗口中，先输入 Ubuntu 服务器的 IP 地址，然后点击“连接”按钮去连接服务器

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225153047.png)

3. 在随后弹出的登录界面中，需要先填入 Ubuntu 服务器的用户名和密码，然后再点击“OK”按钮

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225153111.png)

4. 没有问题的话，这样就可以登录进去了

### ⑤、通过 Windows 远程桌面连接 Ubuntu 桌面问题记录

#### Ⅰ、Windows 远程连接后没有声音

> 1. xrdp pulseaudio 音频重定向：https://github.com/neutrinolabs/pulseaudio-module-xrdp/wiki/README
> 	1. v0.7 下载：[pulseaudio-module-xrdp-0.7.zip](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fpulseaudio-module-xrdp-0.7.zip)
> 2. xrdp pulseaudio 音频重定向依赖 pulseaudio：https://www.freedesktop.org/wiki/Software/PulseAudio/Download/
> 	1. 17.0 下载：[pulseaudio-17.0.tar.gz](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fpulseaudio-17.0.tar.gz)
> 3. 上面两个安装过程中会出现很多依赖的问题，善用 gpt 排查

##### （1）、pulseaudio 编译安装

1. 查看原有的 `pulseaudio` 版本：

```shell
pulseaudio --version
```

2. 若是有输出则表示已经有安装，则执行下面的卸载；若是找不到命令，则表示没有安装，直接往下执行安装的步骤即可

```shell
sudo apt-get remove pulseaudio

sudo apt-get autoremove  # 移除未使用的依赖
```

3. 下载上面的 `pulseaudio-17.0.tar.gz` ，并解压到目录：`/home/yan/apply/tools/pulseaudio/`；或者使用 git：

```shell
# 进入 pulseaudio 应该存放的目录
cd /home/yan/apply/tools/

# git 协议
git clone git://anongit.freedesktop.org/pulseaudio/pulseaudio
# 如果在连接时遇到问题（由于防火墙等原因），请尝试使用较慢的 HTTP 协议
git clone http://anongit.freedesktop.org/git/pulseaudio/pulseaudio.git
```

4. 安装 PulseAudio 编译的依赖项；可能不完整，需根据提示安装缺失的包：

```shell
sudo apt-get update
sudo apt-get install -y build-essential libtool autoconf automake pkg-config libasound2-dev libpulse-dev libaudio-dev libjack-jackd2-dev libsndfile1-dev libudev-dev libavahi-client-dev libjson-c-dev libspeex-dev libspeexdsp-dev libglib2.0-dev libwebrtc-audio-processing-dev libsoxr-dev meson

# 安装 Linux capabilities 依赖，否则会有警告
sudo apt-get install libcap-dev
```

5. 安装 Meson 项目构建系统

```shell
sudo apt-get update

sudo apt-get install meson
```

6. 配置构建系统，创建一个构建目录（Meson 建议构建在源代码之外的目录进行），然后在该目录内配置构建环境：

```shell
# 进入 pulseaudio 所在目录
cd /home/yan/apply/tools/pulseaudio/
# 创建 build 目录
mkdir build && cd build

# 配置构建环境
meson setup ..
```

7. 编译 PulseAudio；执行该命令时可能会因为缺少依赖报错，善用 gpt 排查

```shell
meson compile
```

8. 安装 PulseAudio

```shell
sudo meson install
```

9. 查看的 `pulseaudio` 版本：

```shell
steam@yan:~$ pulseaudio --version
W: [pulseaudio] caps.c: Normally all extra capabilities would be dropped now, but that's impossible because PulseAudio was built without capabilities support.
pulseaudio 17.0-6-g84f5
steam@yan:~$ 
```

10. 有输出即为安装成功，本次的版本为：`17.0-6-g84f5`；关于警告的解释：
	1. W: 【pulseaudio】 caps.c: Normally all extra capabilities would be dropped now, but that's impossible because PulseAudio was built without capabilities support.
	2. 这条警告信息意味着 PulseAudio 想要放弃某些 Linux capabilities 来提高系统的安全性，但由于在编译 PulseAudio 时没有启用相应的支持，所以无法执行这个操作。在 Linux 中，capabilities 允许给予进程一些超出标准用户权限的特殊能力，而不是给予它们完全的 root 权限，这有助于降低系统的安全风险。
	3. 之后会解决这个问题，也可以放着不管
	4. 出现警告是因为没有 `libcap-dev` 依赖，现在上面已经加上这个依赖了，所以应该不会有这个警告了
11. 若是找不到命令，则可能是系统变量未更新的原因
12. 确认 PulseAudio 的安装位置：PulseAudio 应该安装在 `/usr/local/bin`，可以通过执行以下命令来确认这一点。如果该命令返回了 PulseAudio 的执行文件路径，则说明 PulseAudio 已经正确安装在该位置

```shell
ls /usr/local/bin/pulseaudio
```

13. 更新 PATH 环境变量，编辑用户环境变量配置文件；此操作只是给当前用户增加环境变量：

```shell
# 编辑用户变量配置文件
nano ~/.bashrc

# 在最底部增加以下内容：
export PATH=$PATH:/usr/local/bin
```

14. 运行指令刷新环境变量：

```shell
source ~/.bashrc
```

15. 再次查看的 `pulseaudio` 版本：

```shell
pulseaudio --version
```

##### （2）、pulseaudio-module-xrdp 编译安装

1. 下载上面的 `pulseaudio-module-xrdp-0.7.zip` 并解压到目录：`/home/yan/apply/tools/pulseaudio-module-xrdp-0.7/`，
2. 安装 PulseAudio 编译的依赖项，可能不完整，需根据提示安装缺失的包：

```shell
sudo apt-get update

sudo apt-get install build-essential git automake libtool libpulse-dev
```

3. 运行 bootstrap 脚本：

```shell
./bootstrap
```

4. 配置项目，指定 `pulseaudio` 的编译目录；

```shell
# 指定 pulseaudio 的编译目录
PULSE_DIR=/home/yan/apply/tools/pulseaudio/

# 根据设定的参数，配置项目
./configure
```

5. 编译项目：

```shell
make
```

6. 安装 `pulseaudio-module-xrdp`：

```shell
sudo make install
```

7. 手动启动加载脚本：`/home/yan/apply/tools/pulseaudio-module-xrdp-0.7/instfiles/load_pa_modules.sh`
8. 安装完成后，您可以通过以下命令确认模块是否正确安装，有以下输出即为安装成功：

```shell
ls $(pkg-config --variable=modlibexecdir libpulse) | grep xrdp
module-xrdp-sink.la
module-xrdp-sink.so
module-xrdp-source.la
module-xrdp-source.so
yan@yan:~/apply/tools/pulseaudio$ 
```

##### （3）、启动

1. 重新启动 PulseAudio：

```shell
# 关闭 PulseAudio
pulseaudio --kill

# 启动 PulseAudio
pulseaudio --start
```

2. 手动启动加载脚本：`/home/yan/apply/tools/pulseaudio-module-xrdp-0.7/instfiles/load_pa_modules.sh`
3. 此时在 设置 -> 声音 中，输入和输出设备应该都显示 `xrdp`

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240326144331.png)

##### （4）、创建桌面文件 pulseaudio-xrdp.desktop

> 1. 桌面文件 `pulseaudio-xrdp.desktop` 在 xrdp 环境中起着自动启动 PulseAudio 模块的作用。
> 2. 这个文件遵循 XDG Autostart 规范，它允许在用户登录并启动桌面环境时自动执行特定的脚本或应用程序。
> 3. 具体到 `pulseaudio-xrdp.desktop` 文件，它的目的是在 xrdp 会话开始时自动调用 `load_pa_modules.sh` 脚本，从而加载必要的 PulseAudio 模块以支持音频重定向。
> 4. 通过将此文件放置在 `/etc/xdg/autostart/` 目录下，当用户登录并启动桌面环境时，桌面环境的启动过程会自动检查该目录下的 `.desktop` 文件，并执行它们定义的命令。
> 5. 这意味着，对于支持 XDG Autostart 规范的桌面环境（大多数现代桌面环境都支持），`pulseaudio-xrdp.desktop` 会自动执行，从而无需用户手动干预就可以加载 xrdp 需要的 PulseAudio 模块。
> 6. 这个机制确保了在通过 xrdp 连接到远程桌面时，音频输入和输出可以正常工作，为用户提供流畅的音频体验。

1. 进入目录 `/etc/xdg/autostart/`

```shell
cd /etc/xdg/autostart/
```

2. 创建或打开 `pulseaudio-xrdp.desktop`

```shell
sudo nano pulseaudio-xrdp.desktop
```

3. 写入以下内容：

```shell
[Desktop Entry]
# 定义了这个文件遵循的桌面入口标准版本，确保兼容性
Version=1.0
# 指定这个桌面入口的显示名称，用户可以在菜单中看到这个名称
Name=PulseAudio xrdp modules
# 提供关于这个桌面入口的功能或用途的额外信息，帮助用户理解它的作用
Comment=Load PulseAudio Modules for xrdp
# 指定当这个桌面入口被激活时要执行的命令，这里是加载 PulseAudio 模块的脚本路径
Exec=/home/yan/apply/tools/pulseaudio-module-xrdp-0.7/instfiles/load_pa_modules.sh
# 控制是否在执行命令时打开终端窗口。这里设置为 false，意味着不打开终端窗口
Terminal=false
# 指定这个文件的类型。对于启动应用程序或脚本，这个值应该是 Application
Type=Application
# 定义这个入口所属的类别，有助于在应用菜单中适当地分类和显示。这里归类为系统工具
Categories=System;Utility;
# 提供一个通用名称，描述这个桌面入口的功能，有助于在不同语言环境下提供更清晰的说明
GenericName=PulseAudio XRDP Module Loader
```

4. 按 `ctrl + s` 保存，再按 `ctrl + x` 退出 nano 即可
5. 之后连接 `xrdp` 桌面时即会自动启动 xrdp pulseaudio 音频重定向

##### （5）、解决 pulseaudio 警告

> W: 【pulseaudio】 caps.c: Normally all extra capabilities would be dropped now, but that's impossible because PulseAudio was built without capabilities support.
> 
> 关于警告的解释：这条警告信息意味着 PulseAudio 想要放弃某些 Linux capabilities 来提高系统的安全性，但由于在编译 PulseAudio 时没有启用相应的支持，所以无法执行这个操作。在 Linux 中，capabilities 允许给予进程一些超出标准用户权限的特殊能力，而不是给予它们完全的 root 权限，这有助于降低系统的安全风险。
> 所以安装 Linux capabilities 后再编译就可以了

1. 安装 libcap 开发包：

```shell
sudo apt-get install libcap-dev
```

2. 进入 PulseAudio 的源代码目录，并清理上次的构建结果（如果有的话）：

```shell
# 进入 PulseAudio 的源代码目录
cd /home/yan/apply/tools/pulseaudio/

# 或使用适当的清理命令
meson setup build --reconfigure
```

3. 进入 PulseAudio 的源代码目录中的 build 目录，删除其中的全部内容：

```shell
# 进入 PulseAudio 的源代码目录中的 build 目录
cd /home/yan/apply/tools/pulseaudio/build/

# 删除其中的全部内容；小心使用
rm -rf /home/yan/apply/tools/pulseaudio/build/
```

4. 卸载之前手动编译安装的 pulseaudio，需要在编译目录中执行该命令

```shell
sudo ninja uninstall
```

5. 配置构建系统：

```shell
meson setup ..
```

6. 编译 PulseAudio：

```shell
meson compile
```

7. 安装 PulseAudio

```shell
sudo meson install
```

8. 查看的 `pulseaudio` 版本：

```shell
yan@yan:~/apply/tools/pulseaudio/build$ pulseaudio --version
pulseaudio 17.0-6-g84f5
yan@yan:~/apply/tools/pulseaudio/build$ 
```

#### Ⅱ、远程登录后弹出需要验证的窗口

1. 有时候登录后还弹出一个如下图所示的认证窗口，那么还需要再输入一次密码来认证，这样显得有点麻烦。

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225153514.png)

2. 如果不想弹出这个认证窗口，可以在 Ubuntu 中执行下面的命令：

```shell
sudo nano /etc/polkit-1/localauthority/50-local.d/45-allow-colord.pkla
```

3. 然后将下面的内容粘贴到文件里面：

```shell
[Allow Colord all Users]
Identity=unix-user:*
Action=org.freedesktop.color-manager.create-device;org.freedesktop.color-manager.create-profile;org.freedesktop.color-manager.delete-device;org.freedesktop.color-manager.delete-profile;org.freedesktop.color-manager.modify-device;org.freedesktop.color-manager.modify-profile
ResultAny=no
ResultInactive=no
ResultActive=yes
```

4. 重启 Ubuntu 系统后，再远程登录就不会弹出这个窗口了

#### Ⅲ、画面卡顿

##### （1）、调整 Xrdp 配置参数

1. 首先查看两个值：输入以下两个命令，三个值分别是：最小值、默认值、最大值

```shell
yan@yan:~/桌面/clash$ cat /proc/sys/net/ipv4/tcp_wmem 
4096	16384	4194304
yan@yan:~/桌面/clash$ cat /proc/sys/net/ipv4/tcp_rmem 
4096	131072	6291456
yan@yan:~/桌面/clash$ 
```

2. 编辑 `/etc/xrdp/xrdp.ini` 文件：`sudo nano /etc/xrdp/xrdp.ini`
3. 其中 `tcp_send_buffer_bytes`、`tcp_recv_buffer_bytes` 两个参数默认被注释了，取消注释，根据上面查询的值来设置

```shell
tcp_send_buffer_bytes=4194304
tcp_recv_buffer_bytes=6291456
```

##### （2）、调整系统参数

1. 调整系统参数，临时生效

```shell
sudo sysctl -w net.core.rmem_max=12582912
sudo sysctl -w net.core.wmem_max=8388608
```

2. 重启后保留，将以下内容写入配置文件 `/etc/sysctl.conf`
3. 编辑配置文件：`sudo nano /etc/sysctl.conf`

```shell
net.core.rmem_max = 12582912
net.core.wmem_max = 8388608
```

4. 然后执行：`sudo sysctl -p`
5. 重启 xrdp 服务使其生效：`sudo systemctl restart xrdp`

#### Ⅳ、无法复制

1. 重启 xrdp 或是注销用户后重新登录可恢复功能

#### Ⅴ、远程登录后是黑屏状态

1. 如果远程登录后并没有出现 Ubuntu 桌面而是黑屏状态，那么可能是已经有用户登录进去了
2. 需要先把之前的用户退出来（Log Out），如果更直接一点就是重启 Ubuntu 系统

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231225153222.png)

### ⑥、

## 4、端口设置

### ①、查看已经开启的端口：

```shell
sudo ufw status numbered
```

### ②、Ubuntu 开启或关闭指定端口

#### Ⅰ、开启指定端口

1. 比如要开启 3389 `tcp` 和 `udp` 端口：

```shell
sudo ufw allow from any to any port 3389
```

2. 开启 3389 tcp 端口

```shell
sudo ufw allow from any to any port 3389 proto tcp
```

3. 开启 3389 udp 端口

```shell
sudo ufw allow from any to any port 3389 proto udp
```

#### Ⅱ、关闭指定端口

1. 查看当前 UFW 的规则列表：

```shell
sudo ufw status numbered
```

2. 若是提示：`状态：不活动`，表示防火墙未开启，需开启防火墙：

```shell
sudo ufw enable
```

3. 若是防火墙已开启，则找到想删除的规则编号：
	1. `3389/tcp`：表示该编号代表是 3389 `tcp` 端口
	2. `8000`：表示该编号代表是 8000 `tcp` 和 `udp` 端口
	3. `3389/tcp (v6)`：表示该编号代表是 3389 `tcp` 的 `ipv6` 端口
	4. `8000 (v6)`：表示该编号代表是 8000 `tcp` 和 `udp` 的 `ipv6` 端口

```shell
root@yan:~# sudo ufw status numbered
状态： 激活

     至                          动作          来自
     -                          --          --
[ 1] 3389/tcp                   ALLOW IN    Anywhere                  
[ 2] 8000                       ALLOW IN    Anywhere  
[ 3] 3389/tcp (v6)              ALLOW IN    Anywhere (v6)   
[ 4] 8000 (v6)                  ALLOW IN    Anywhere (v6)    

root@yan:~# 
```

4. 根据具体端口号来关闭指定端口：

```shell
# 关闭 3389 tcp 和 udp 端口：
sudo ufw delete allow from any to any port 3389

# 分别关闭 3389 TCP 和 UDP 端口：
sudo ufw delete allow from any to any port 3389 proto tcp
sudo ufw delete allow from any to any port 3389 proto udp
```

5. 根据编号来关闭指定端口：

```shell
sudo ufw delete [规则编号]
```

### ③、Ubuntu 开启所有端口

1. 允许所有传入和传出的连接：使用 iptables 命令来允许所有传入和传出的连接。执行以下命令来清除所有已有的规则，并允许所有连接：

```shell
sudo iptables -F
sudo iptables -P INPUT ACCEPT
sudo iptables -P FORWARD ACCEPT
sudo iptables -P OUTPUT ACCEPT
sudo iptables-save
```

2. 允许所有传入和传出的连接（IPv6）：如果你使用的是IPv6，执行以下命令来允许所有传入和传出的IPv6连接：

```shell
sudo ip6tables -F
sudo ip6tables -P INPUT ACCEPT
sudo ip6tables -P FORWARD ACCEPT
sudo ip6tables -P OUTPUT ACCEPT
sudo iptables-save
```

2. 这样可以开放所有端口（如需开启指定端口，可以使用 `iptables -I INPUT -p tcp --dport 8080 -j ACCEPT` ），
3. 但是如果服务器重启，不会保存。为了使更改在系统重启后仍然生效，需要将它们保存到防火墙规则配置文件中。
4. 在 Ubuntu 中，iptables 的规则通常在 `/etc/iptables/rules.v4` 文件中，而 IPv6 规则在 `/etc/iptables/rules.v6` 文件中。
5. 以下是保存 `iptables` 规则的步骤：
6. 保存 IPv4 规则：

```shell
sudo sh -c 'iptables-save > /etc/iptables/rules.v4'
```

7. 保存 IPv6 规则：

```dart
sudo sh -c 'ip6tables-save > /etc/iptables/rules.v6'
```

8. 这样，在系统重启后，防火墙规则将会从这些文件加载，使更改保持生效。

### ④、使用 nc（netcat）工具测试网络连通性

> 服务端：测试的机器，本次测试就是为了测试此机器的网络连通性
> 
> 客户端：帮助测试的机器，用于测试服务端的端口是否可以联通

#### Ⅰ、测试 TCP 连接

1. 在服务器端，打开一个端口监听，例如监听 9001 端口：

```shell
nc -l 9001
```

2. 在客户端，尝试连接到服务器的 9001 端口：

```shell
nc [服务器IP地址] 9001
```

3. 如果连接成功，可以在客户端输入文本，然后在服务器端看到相同的文本，这表明 TCP 连接是成功的。

#### Ⅱ、测试 UDP 连接

1. 在服务器端，使用 -u 选项监听一个 UDP 端口，例如监听 9001 端口：

```shell
nc -ul 9001
```

2. 在客户端，同样使用 -u 选项尝试连接到服务器的 9001 端口：

```shell
nc -u [服务器IP地址] 9001
```

3. 客户端和服务器端可以相互发送和接收消息，验证 UDP 连接。

### ⑤、

### ⑥、

## 5、系统设置

### ①、配置环境变量

#### Ⅰ、单用户使用

1. 下载对应环境的二进制文件并解压到指定位置，如：`/home/yan/IDE/Java/JDK/jdk-21.0.2/`

```shell
sudo tar -xvzf openjdk-21.0.2_linux-x64_bin.tar.gz -C /home/yan/IDE/Java/JDK
```

2. 打开 `~/.bashrc` 文件进行编辑

```shell
nano ~/.bashrc
```

3. 在文件末尾，添加环境变量配置：

```shell
# 环境变量：jdk 21
export JAVA_HOME=/home/yan/IDE/Java/JDK/jdk-21.0.2
export PATH=$JAVA_HOME/bin:$PATH
```

4. 保存并关闭文件后，执行以下命令使变更生效

```shell
source ~/.bashrc
```

5. 查看配置是否生效：

```shell
java -version
```

#### Ⅱ、多用户使用

1. 创建 `/usr/lib/jvm` 目录

```shell
sudo mkdir -p /usr/lib/jvm
```

2. 下载对应环境的二进制文件并解压到指定位置，如：`/usr/lib/jvm/jdk-21.0.2`

```shell
sudo tar -xvzf openjdk-21.0.2_linux-x64_bin.tar.gz -C /usr/lib/jvm
```

3. 要确保环境变量被设置在一个所有用户都能访问的地方，比如全局环境配置文件 `/etc/profile` 中：

```shell
sudo nano /etc/profile
```

4. 在文件末尾，添加环境变量配置：

```shell
# 环境变量：jdk 21
export JAVA_HOME=/usr/lib/jvm/jdk-21.0.2
export PATH=$JAVA_HOME/bin:$PATH
```

5. 保存并关闭文件后，执行以下命令使变更生效

```shell
source /etc/profile
```

6. 确保普通用户有权限访问 JDK 安装的目录，可以检查 `/usr/lib/jvm/jdk-21.0.2` 目录的权限，确保普通用户至少有读取和执行权限

```shell
sudo chmod -R +r /usr/lib/jvm/jdk-21.0.2
sudo chmod +x /usr/lib/jvm/jdk-21.0.2/bin/*
```

7. 查看配置是否生效：

```shell
java -version
```

### ②、将应用软件加入启动器和桌面快捷方式

> ubuntu下桌面配置文件 `*.desktop` 存放路径为 `/usr/share/applications` 
> 
> 该文件夹下存在的软件自然可以直接复制到桌面和加入启动器，但有些自己安装的软件（如解压缩包的软件）没有自动生成桌面配置文件，自然不能直接获得桌面快捷方式或加入启动器。

1. 命令行进入 `/usr/share/applications`：

```shell
cd /usr/share/applications
```

2. 该目录下添加桌面配置文件 `idea.desktop`

```shell
sudo nano idea.desktop
```

3. 在文件中加入以下配置内容，根据情况修改参数：

```shell
[Desktop Entry]
# 指定文件的编码格式
Encoding=UTF-8
# 应用程序的显示名称
Name=Idea
# 应用程序的描述
Comment=Idea
# 指定要执行的可执行文件的路径和名称。可以使用多种类型的命令或脚本作为 Exec 的参数，包括：
# 可执行文件的路径：可以直接指定可执行文件的完整路径，例如 /usr/bin/firefox。
# 脚本文件的路径：可以指定一个可执行的脚本文件的路径，例如 /path/to/your/script.sh。
# 命令行命令：可以指定一个命令行命令，例如 firefox 或 gnome-terminal。在这种情况下，系统会在 PATH 环境变量中查找该命令并执行它。
Exec=/home/yan/Idea/IntelliJ-ideaIU-2023.2.5/bin/idea
# 指定应用程序的图标文件的路径和名称；支持 PNG、SVG、ICO、XPM 格式
Icon=/home/yan/Idea/IntelliJ-ideaIU-2023.2.5/bin/idea.svg
# 指定是否在打开应用程序时启动终端
Terminal=false
# 指定是否在应用程序启动时显示通知
StartupNotify=true
# 指定应用程序的类型。通常为 Application，表示这是一个普通的应用程序
# Application：应用程序类型，用于表示一个可执行的应用程序。
# Link：链接类型，用于表示一个指向其他文件或网页的链接。
# Directory：目录类型，用于表示一个文件夹。
# File：文件类型，用于表示一个单独的文件。
# Service：服务类型，用于表示一个系统服务。
# MimeType：MIME 类型，用于表示一个特定的文件类型。
# Link：链接类型，用于表示一个指向其他文件或网页的链接。
# FSDevice：文件系统设备类型，用于表示一个文件系统设备。
Type=Application
# 指定应用程序所属的类别
Categories=Application;Development;
```

4. 快捷键 `ctrl + s` 保存，快捷键 `ctrl + x` 退出

### ③、启动默认开启小键盘

1. 打开终端，运行以下命令来编辑 `/etc/X11/xinit/xinitrc` 文件：

```shell
sudo nano /etc/X11/xinit/xinitrc
```

3. 在文件最后添加：

```shell
/usr/bin/numlockx on
```

4. 保存并关闭文件（使用 `Ctrl + O` 保存，`Ctrl + X` 退出）。
5. 重新启动系统。

### ④、设置系统时区

1. 查看当前时区：`timedatectl`
	1. 下面的这个输出表示系统当前设置的时区是 `Etc/UTC`。
	2. 这表示系统时区被设置为协调世界时（UTC），并且没有任何时差偏移，即 +0000。
	3. 所以，这个系统时间与世界标准时间是一致的。

```shell
yan@yuehai:~$ timedatectl
               Local time: Mon 2024-07-15 07:40:30 UTC
           Universal time: Mon 2024-07-15 07:40:30 UTC
                 RTC time: Mon 2024-07-15 07:40:31    
                Time zone: Etc/UTC (UTC, +0000)       
System clock synchronized: yes                        
              NTP service: active                     
          RTC in local TZ: no                         
yan@yuehai:~$ 
```

2. 查看可用的时区列表，特别是中国的时区：

```shell
timedatectl list-timezones | grep Asia/Shanghai
```

3. 设置时区为中国上海（UTC+8）：

```shell
sudo timedatectl set-timezone Asia/Shanghai
```

4. 验证时区设置是否成功：`timedatectl`

```shell
yan@yuehai:~/apply/n2n-edge-query-check$ timedatectl
               Local time: Tue 2024-07-16 08:35:49 CST
           Universal time: Tue 2024-07-16 00:35:49 UTC
                 RTC time: Tue 2024-07-16 00:35:50    
                Time zone: Asia/Shanghai (CST, +0800) 
System clock synchronized: yes                        
              NTP service: active                     
          RTC in local TZ: no                         
yan@yuehai:~/apply/n2n-edge-query-check$ 
```

### ⑤、定时任务

1. 首先编写需要定时执行的脚本 `nano /home/yan/apply/crontab_test.sh`：

```shell
#!/bin/bash

# 向 pal_server.log 文件中追加日志
echo "【$(date)】：定时任务运行日志" >> $path/pal_server.log
```

2. 在终端中输入 `crontab -e`，这将打开个人 `crontab` 文件进行编辑
3. 在 `crontab` 文件中添加一行，指定时间和要执行的命令。比如要在每天凌晨 1 点执行命令：

```shell
0 1 * * * /home/yan/apply/crontab_test.sh
```

4. 在每月、每周、每天、每个小时、每分钟都执行一次脚本：

```shell
* * * * * /home/yan/apply/crontab_test.sh
```

5. 在 `cron` 表达式中，参数用于指定定时任务的执行时间。一个标准的 `cron` 表达式由五个或六个字段组成，每个字段代表不同的时间单位：
	1. 分钟（Minute）：0 ~ 59，代表一小时中的哪一分钟执行任务。
	2. 小时（Hour）：0 ~ 23，代表一天中的哪一个小时执行任务。0 代表午夜，23 代表晚上 11 点。
	3. 日（Day of the Month）：范围：1 ~ 31，代表一个月中的哪一天执行任务。
	4. 月（Month）：1 ~ 12 或使用月份名称的缩写（例如，1代表一月，2代表二月，等等），代表一年中的哪一个月份执行任务。
	5. 星期几（Day of the Week）：0 ~ 7 或使用星期名称的缩写（0和7都代表星期日，1代表星期一，等等）代表一周中的哪一天执行任务。
6. 在编辑完 `crontab` 后，保存并退出编辑器，`crontab` 会自动安装新的计划任务。可以通过 `crontab -l` 命令查看当前的 `crontab` 任务列表，以确认任务已正确设置
7. 若是在更改系统时区后，定时任务不在预期时间运行的原因可能与 cron 守护进程的时区设置有关。cron 通常在系统启动时加载，并使用那时的系统时区设置。如果在系统运行期间更改时区，cron 进程可能不会自动更新为新的时区设置。
8. 重新加载并使用当前的系统时区。你可以通过以下命令来重启 cron 服务：

```shell
sudo service cron restart
```

9. 或者使用：

```shell
sudo systemctl restart cron
```

### ⑥、

## 6、问题记录

### ①、使用 dos2unix 转换换行符格式

1. 报错信息：

```shell
-bash: ./run_jar.sh: /bin/bash^M: bad interpreter: No such file or directory
```

2. 原因：错误信息中的 `^M` 表示的是 Windows 风格的换行符（Carriage Return + Line Feed），而在 Unix/Linux 系统中使用的是 Line Feed。这种不同的换行符格式可能导致解释器无法正确识别脚本文件。
3. 解决：使用 `dos2unix` 命令将脚本文件的换行符格式转换为 Unix 格式。在终端中执行以下命令：

```shell
# run_jar.sh 替换为需要转换的文件
dos2unix run_jar.sh
```

4. 若是提示以下内容，则需要安装 dos2unix

```shell
Command 'dos2unix' not found, but can be installed with:
apt install dos2unix
Please ask your administrator.
```

5. 更新软件源

```shell
sudo apt update
```

6. 执行以下命令安装 dos2unix

```dart
apt install dos2unix
```

### ②、使用 sed 转换换行符格式

1. 上面是使用 dos2unix 转换的，也可以直接使用 `sed` 命令进行替换：

```shell
sed -i 's/\r$//' run_jar.sh
```

### ③、查看一个目录以及其中所有文件和子目录的总大小

1. 基本命令：
	1.  `-s`：表示汇总指定目录的总大小
	2. `-h`：使输出以易于阅读的格式（如 KB、MB 或 GB）显示。

```shell
du -sh /path/to/directory
```

2. 如果想看到每个子目录的大小而不仅仅是总大小，可以省略 `-s` 选项。这会列出所有子目录及其大小：

```shell
du -h /path/to/directory
```

3. 查看特定深度的目录大小：
	1. `--max-depth=1`：表示只显示直接子目录的大小。
	2. 可以将 1 替换为其他数字来指定不同的深度。

```shell
du -h --max-depth=1 /path/to/directory
```

### ④、定时挂载和卸载硬盘的脚本

1. 在目录 `/home/yan/apply/file/YottaMaster/` 中创建日志文件：`mount-unmount-disks.log`

```shell
touch mount-unmount-disks.log
```

2. 在目录 `/home/yan/apply/file/YottaMaster/` 中创建脚本：`mount-unmount-disks.sh`，编写以下内容

```shell
touch mount-unmount-disks.sh
```

```shell
#!/bin/bash

# 检查是否传入了参数：mount 或 unmount，否则提示用法并退出
if [ $# -ne 1 ]; then
    echo "用法: $0 <mount|unmount>"
    exit 1
fi

# 根据参数设定操作类型
operation=$1

# 硬盘设备标识列表，以空格分隔
devices=("/dev/sda2" "/dev/sdb2")
# 硬盘设备名称列表，以空格分隔；这是 Bash 4.0 新增的关联数组语法
declare -A DISK_NAME
# 为每个设备设置名称，用于日志记录
DISK_NAME["/dev/sda2"]="东芝V10-4t"
DISK_NAME["/dev/sdb2"]="hc330-10t"

# 日志文件路径
log_file="/home/yan/apply/file/YottaMaster/mount-unmount-disks.log"

# 函数：记录日志
log_action() {
    echo "【$(date "+%Y-%m-%d %H:%M:%S")】$1" >> "$log_file"
}

# 函数：检查并处理忙碌的设备
handle_busy_device() {
    local device=$1
    echo "检查设备 $device 是否忙碌..."

    # 使用 lsof 检查设备，获取占用设备的进程列表
    local busy_procs=$(lsof $device 2>/dev/null | awk '{print $2}' | tail -n +2 | uniq)

    if [ -n "$busy_procs" ]; then
        # 输出被占用信息到日志
        log_action "设备 $device 被以下进程占用：$busy_procs"

        # 这里可以选择杀掉这些进程或者给出警告让用户手动处理，例如，杀掉进程:
        for pid in $busy_procs; do
            kill -9 $pid
        done

        # 输出杀死进程信息到日志
        log_action "已尝试杀死占用 $device 的进程"
    fi
}

# 函数：挂载设备
mount_device() {
    # 参数 $1 代表设备标识
    local device=$1

    # 因为挂载命令需要输入密码，所以使用 expect 脚本自动化交互式命令
    # 1、mount_output=$(expect -c " ... ") 代表执行 expect 命令，并将输出保存到变量 mount_output
    # 2、set timeout 300 代表设置超时时间为 300 秒，超时后自动退出
    # 3、spawn /usr/bin/udisksctl mount -b $1 代表执行挂载命令，$1 代表传入的设备标识
    # 4、expect "Password:" 代表等待输出中出现 "Password:" 字符串
    # 5、send "000123\r" 代表发送密码 "000123" 并回车
    # 6、expect eof 代表等待输出结束
    local mount_output=$(expect -c "
        set timeout 300
        spawn /usr/bin/udisksctl mount -b $device
        expect \"Password:\"
        send \"000123\r\"
        expect eof
    ")

    if echo "$mount_output" | grep -q 'Mounted'; then
        log_action "挂载设备 $device at ${DISK_NAME["$device"]} 成功"
    else
        log_action "挂载设备 $device at ${DISK_NAME["$device"]} 失败：$mount_output"
    fi
}

# 函数：卸载设备
unmount_device() {
    # 参数 $1 代表设备标识
    local device=$1
    # 默认重试次数为 3 次；${2:-3} 代表如果传入了第二个参数，则使用传入的值，否则使用默认值 3
    local attempts=${2:-3}

    # 直接使用 udisksctl 命令卸载设备，不需要输入密码
    local unmount_output=$(/usr/bin/udisksctl unmount -b $device 2>&1)

    # 检查输出是否包含 'Unmounted'，判断卸载是否成功，并记录到日志文件
    if echo "$unmount_output" | grep -q 'Unmounted'; then
        log_action "卸载设备 $device from ${DISK_NAME["$device"]} 成功"
        return 0
    else
        # 卸载失败，记录到日志文件
        log_action "尝试卸载设备 $device from ${DISK_NAME["$device"]} 失败: $unmount_output"
        # 如果重试次数大于 1，则处理设备忙碌情况，等待 3 秒后递归调用自身，次数减一；否则记录最终失败信息
        if (( attempts > 1 )); then
            # 处理设备忙碌的情况
            handle_busy_device "$device"
            # 等待 3 秒
            sleep 3
            # 递归调用自身，次数减一
            unmount_device "$device" $((attempts - 1))
        else
            log_action "卸载设备 $device from ${DISK_NAME["$device"]} 最终失败"
            return 1
        fi
    fi
}

# 主循环：根据操作类型遍历设备列表，挂载或卸载
for device in "${devices[@]}"; do
    mount_info=$(mount | grep "$device")

    # 判断是否执行挂载操作
    if [ "$operation" == "mount" ]; then
        # 判断设备是否已经挂载，如果已经挂载则跳过，否则执行挂载操作
        if [ -n "$mount_info" ]; then
            log_action "设备 $device on ${DISK_NAME["$device"]} 已经挂载，跳过..."
        else
            mount_device "$device"
        fi
    # 判断是否执行卸载操作
    elif [ "$operation" == "unmount" ]; then
        # 判断设备是否已经挂载，如果已经挂载则执行卸载操作，否则跳过
        if [ -n "$mount_info" ]; then
            unmount_device "$device"
        else
            log_action "设备 $device on ${DISK_NAME["$device"]} 未挂载，跳过..."
        fi
    # 未知操作类型，提示用法并退出
    else
        echo "未知操作: $operation" >> "$log_file"
        echo "用法: $0 <mount|unmount>"
        exit 2
    fi
done

echo "挂载/卸载设备完成" >> "$log_file"
echo "----------------------------------------------------------------" >> "$log_file"
echo "" >> "$log_file"
```

3. 设置脚本权限：

```shell
chmod 755 mount-unmount-disks.sh
```

4. 设置定时执行：
5. 在终端中输入 `crontab -e`，这将打开个人 `crontab` 文件进行编辑
6. 在 `crontab` 文件中添加一行，指定时间和要执行的命令：

```shell
# 挂载硬盘：每周五 18:30
30 18 * * 5 /home/yan/apply/file/YottaMaster/mount-unmount-disks.sh mount
# 卸载硬盘：每周末 18:00
00 18 * * 7 /home/yan/apply/file/YottaMaster/mount-unmount-disks.sh unmount
```

7. 在 cron 表达式中，参数用于指定定时任务的执行时间。一个标准的 cron 表达式由五个或六个字段组成，每个字段代表不同的时间单位：
	1. 分钟（Minute）：0 ~ 59，代表一小时中的哪一分钟执行任务。
	2. 小时（Hour）：0 ~ 23，代表一天中的哪一个小时执行任务。0 代表午夜，23 代表晚上 11 点。
	3. 日（Day of the Month）：范围：1 ~ 31，代表一个月中的哪一天执行任务。
	4. 月（Month）：1 ~ 12 或使用月份名称的缩写（例如，1代表一月，2代表二月，等等），代表一年中的哪一个月份执行任务。
	5. 星期几（Day of the Week）：0 ~ 7 或使用星期名称的缩写（0和7都代表星期日，1代表星期一，等等）代表一周中的哪一天执行任务。
8. 在编辑完 `crontab` 后，保存并退出编辑器，`crontab` 会自动安装新的计划任务。可以通过 `crontab -l` 命令查看当前的 `crontab` 任务列表，以确认任务已正确设置

### ⑤、

### ⑥、

## 7、软件使用

### ①、nano 和 vim

1. 在新安装的 Ubuntu 桌面中，`nano` 是自带的简单易用的文本编辑器，和 `vim` 类似
2. 它提供了基本的编辑功能和快捷键，如复制、粘贴、查找和替换等。可以通过以下命令来打开文件并使用 `nano` 编辑器：

```shell
nano 文件名
```

3. 在`nano`中，底部会显示一些常用的命令提示，例如，使用 `Ctrl + O` 保存文件，使用 `Ctrl + X` 退出编辑器。
4. 以下是 `nano` 文本编辑器中常用的一些快捷键：

| 快捷键   | 介绍                                                                        |
| -------- | --------------------------------------------------------------------------- |
| Ctrl + G | 显示帮助菜单，其中包含所有可用的快捷键和命令。                              |
| Ctrl + O | 保存文件并退出，按下后会提示你输入文件名，按下Enter确认保存。               |
| Ctrl + S | 保存文件。                                                                  |
| Ctrl + X | 退出编辑器，如果有未保存的更改，会提示你是否保存。                          |
| Ctrl + K | 剪切当前行。                                                                |
| Ctrl + U | 粘贴剪切的内容到当前位置。                                                  |
| Ctrl + W | 查找关键词，按下后会提示你输入要查找的关键词，按下Enter开始查找。           |
| Ctrl + \ | 替换关键词，按下后会提示你输入要替换的关键词和替换内容，按下Enter开始替换。 |
| Ctrl + C | 显示光标所在位置的行号和列号。                                              |
| Ctrl + J | 将光标移动到当前行的结尾。                                                  |
| Ctrl + A | 将光标移动到当前行的开头。                                                  |
| Ctrl + E | 将光标向下移动一行。                                                        |
| Ctrl + Y | 将光标向上移动一行。                                                        |
| Ctrl + V | 向下滚动一屏。                                                              |
| Ctrl + Y | 向上滚动一屏。                                                              |

### ②、linux 下使用 clash

1. 下载 clash 客户端，一般个人的64位电脑下载 clashpremium-linux-amd64 即可
	1. github 下载： [clash 客户端](https://github.com/DustinWin/clash-tools/tree/main/ClashPremium-release)
	2. 本地 2023.08.17 版：[clashpremium-linux-amd64](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fclashpremium-linux-amd64)

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231226134647.png)

2. 在 linux 中创建 clash 目录，然后进入

```shell
mkdir ~/clash; cd ~/clash
```

3. 将下载的文件传输到该目录中，<font color="#ff0000">并重命名为 clash</font>
4. 下载 Clash 配置文件，指令从这里获取：[ikuuu.org](https://ikuuu.org/user/tutorial?os=linux&client=clash##)

```shell
wget -O config.yaml "https://hpzzf.no-mad-world.club/link/3lzOUap8OTzIV0QA?clash=3"
```

5. 执行 `./clash -d .` 即可启动 Clash，同时启动 HTTP 代理和 Socks5 代理。
	1. `-d [string]`：设置配置目录
	2. `-ext-ctl [string]`：覆盖外部控制器地址
	3. `-ext-ui [string]`：覆盖外部UI目录
	4. `-f [string]`：指定配置文件
	5. `-secret [string]`：覆盖 RESTful API 的密钥
	6. `-t`：测试配置并退出
	7. `-v`：显示当前Clash版本
6. 如提示权限不足，请执行 `chmod +x clash`
7. 浏览器访问 [Clash Dashboard](https://clash.razord.top/) 可以进行切换节点、测延迟等操作。Host: `127.0.0.1`，端口: `9090`

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231226135801.png)

8. 设置系统代理：以 Ubuntu 19.04 为例：
	1. 打开系统设置，选择网络，点击网络代理右边的 ⚙ 按钮
	2. 选择手动，填写 `HTTP`、`HTTPS`、`Socks` 代理为 `127.0.0.1:7890`
	3. 即可启用系统代理

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231226140038.png)

### ③、使用 V2Ray 搭建 vpn

#### Ⅰ、ubuntu 搭建 V2Ray 服务端

> 使用的野草云：https://my.yecaoyun.com/

1. 开放 `10004` 端口

![[attachments/Pasted image 20240627151431.png]]

2. 通过官方脚本来安装 V2Ray，这个脚本会自动配置好 V2Ray

```shell
sudo bash -c "$(curl -fsSL https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-release.sh)"
```

3. 安装完成后，需要配置 V2Ray 来使用 VMess+WebSocket
	1. `port`：V2Ray 使用的端口号
	2. `protocol`：V2Ray 使用的协议
	3. `settings.clients.id`：每个客户端一个唯一的 UUID，可以通过许多在线工具生成
	4. `settings.clients.alterId`：额外的 ID，推荐设置为 64
	5. `streamSettings.network`：传输协议，此处为 `WebSocket ` 协议
	6. `streamSettings.wsSettings.path`：`WebSocket ` 的连接协议

```shell
# 编辑配置文件
sudo nano /usr/local/etc/v2ray/config.json

# 输入以下内容：
{
    "inbounds": [
        {
            "port": 10004,
            "protocol": "vmess",
            "settings": {
                "clients": [
                    {
                        "id": "A675E71B-87BA-CB0E-71D8-4B932F241E6F",
                        "alterId": 64
                    },
                    {
                        "id": "9053C302-6BB9-D9EC-5C0B-6D5B661618DB",
                        "alterId": 64
                    },
                    {
                        "id": "3A789917-A9B1-F9FA-2163-93439B28C607",
                        "alterId": 64
                    },
                    {
                        "id": "A68CEFB1-10F1-BFC3-97EA-A9AB068DFCF5",
                        "alterId": 64
                    },
                    {
                        "id": "FCA42E4D-A0BB-3E8A-8536-CE31ED434CBB",
                        "alterId": 64
                    },
                    {
                        "id": "1F67FB4C-BF09-8FE4-3002-96D2E4A940D7",
                        "alterId": 64
                    },
                    {
                        "id": "4369C60B-3B4C-EC85-DA88-66AE9783904D",
                        "alterId": 64
                    },
                    {
                        "id": "2851648A-9BE0-909F-E3AA-A8C7450E5F55",
                        "alterId": 64
                    },
                    {
                        "id": "2F862300-E39E-AB59-5F56-E0DA67FD75CF",
                        "alterId": 64
                    },
                    {
                        "id": "923EA6F0-150D-BD9D-6EA2-BDF7258D9D39",
                        "alterId": 64
                    }
                ]
            },
            "streamSettings": {
                "network": "ws",
                "wsSettings": {
                    "path": "/v2ray"
                }
            }
        }
    ],
    "outbounds": [
        {
            "protocol": "freedom",
            "settings": {}
        }
    ]
}
```

4. 配置完成后，重启 V2Ray 服务以应用新的配置：

```shell
sudo systemctl restart v2ray
```

5. 要启动 V2Ray 服务：

```shell
sudo systemctl start v2ray
```

6. 停止 V2Ray 服务：

```shell
sudo systemctl stop v2ray
```

7. 查看 V2Ray 服务状态：

```shell
sudo systemctl status v2ray
```

#### Ⅱ、手机端使用 V2Ray

> 软件下载：[v2rayNG_1.8.25.apk](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2Fv2rayNG_1.8.25.apk)

1. 打开软件，点击右上角 + 号

![|254](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240627153200.png)

2. 选择：`手动输入[Vmess]`

![|229](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240627153220.png)

3. 依照下面的图片填入内容：
	1. 地址：服务器的 ip 
	2. 端口：V2Ray 服务端的端口
	3. 用户 ID：之前配置文件 `/usr/local/etc/v2ray/config.json` 的 `settings.clients.id`
	4. 额外 ID：之前配置文件 `/usr/local/etc/v2ray/config.json` 的 `settings.clients.alterId`
	5. 传入协议：选择 `ws`，即 `WebSocket ` 协议
	6. path：之前配置文件 `/usr/local/etc/v2ray/config.json` 的 `streamSettings.wsSettings.path`

![|254](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240627153309.png)

4. 点击右上角 `√` 号保存
5. 选择刚才创建的配置，点击连接即可

![|229](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240627153020.png)

#### Ⅲ、windows 端使用 V2Ray

> 软件下载：https://github.com/2dust/v2rayN/releases

1. 打开软件，点击左上角 `服务器` 按钮

![|625](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240627153707.png)

2. 选择：`添加[Vmess]服务器`

![|625](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240627153728.png)

3. 填入参数，内容与上面的手机端相同

![|625](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240627153807.png)

4. 点击确定，即可使用，软件会自动连接

### ④、Syncthing 文件同步的使用

#### Ⅰ、介绍

1. Syncthing 是跨平台的应用，可在 windows、linux、macOS、ios、android 等平台下载安装，可在不同设备之间同步文件
2. 因为在开发之际确实超前地考虑到全平台的通用性，因此采用了浏览器/服务器（B/S）架构以适应绝大多数操作系统和体系结构
3. Syncthing 的缺点是只能在不同设备之间同步文件，而不能在同一个设备的不同目录（硬盘）之间同步文件
4. 若想要在同一个设备的不同目录（硬盘）之间同步文件，可以使用下面的 FreeFileSync

#### Ⅱ、基本使用

> 下载地址：https://syncthing.net/downloads/

1. 下载对应版本后解压
2. 进入解压目录，启动应用：`./syncthing`
3. 启动成功后，进入网址即可：`http://localhost:8384`

![[attachments/Pasted image 20240624160538.png|700]]

4. 先点击添加远程设备，设备 ID 点击右上角操作 -> 显示设备 ID 获取；设备之间要互相绑定才可以
5. 再点击添加文件夹，<font color="#ff0000">文件夹 ID</font> 必须唯一，不同设备间根据 <font color="#ff0000">文件夹 ID</font> 进行同步
6. 添加完文件夹后，需点击共享，选择想要同步该文件夹的设备，点击保存即可开始同步

![[attachments/Pasted image 20240624161051.png|700]]

#### Ⅲ、设置开机自启

1. 在某个录下创建一个名为 `syncthing.service` 的文件，内容如下：
	1. 需确保 `ExecStart` 参数的<font color="#ff0000">路径正确</font>

```shell
[Unit]
# 服务的描述，说明这个服务是做什么的。
Description=Syncthing - Open Source Continuous File Synchronization
# 提供了关于服务的文档的链接或路径，这里指向了 Syncthing 的手册页。
Documentation=man:syncthing(1)
# 指定了这个服务应该在网络服务完全启动后再启动，确保在启动时网络已可用。
After=network.target

[Service]
# 指定服务的启动类型。simple 是最常用的启动类型，表示由 ExecStart 指定的命令为主服务，服务启动即为该命令启动。
Type=simple
# 指定服务运行的用户，这里是 yan。这意味着 Syncthing 将以 yan 用户的权限运行。
User=yan
# 指定服务启动时执行的命令，这里是 Syncthing 的可执行文件的完整路径。
ExecStart=/home/yan/apply/file/syncthing-linux-amd64-v1.27.8/syncthing
# 服务失败时的重启策略。这里设置为 on-failure，意味着只有在服务异常退出时（如进程退出状态码非零）才会尝试重启。
Restart=on-failure
# 重启服务前等待的时间（秒）。这里设置为 10 秒，意味着服务崩溃后将等待 10 秒再进行重启。
RestartSec=10

[Install]
# 指定服务安装的目标。default.target 是多用户目标的一种通用别名，使服务能够在系统启动时启动。
WantedBy=default.target
```

2. 将服务文件移动到 `systemd` 目录

```shell
sudo mv syncthing.service /etc/systemd/system/
```

3. 重新加载 `systemd` 管理器配置

```shell
sudo systemctl daemon-reload
```

4. 启用服务

```shell
sudo systemctl enable syncthing.service
```

5. 启动服务

```shell
sudo systemctl start syncthing.service
```

6. 检查状态

```shell
sudo systemctl status syncthing.service
```

7. 关闭运行中的 Syncthing，可以在终端中查找其进程并杀掉它：

```shell
# 查找 Syncthing 进程
ps aux | grep syncthing

# 使用 kill 命令终止进程，其中 pid 是从上一步获得的进程 ID
kill [pid]
```

8. 重启服务：

```shell
sudo systemctl restart syncthing.service
```

#### Ⅳ、关闭开机自启

1. 停止服务：

```shell
sudo systemctl stop syncthing.service
```

2. 禁用服务：

```shell
sudo systemctl disable syncthing.service
```

3. 上面这两个命令会停止当前运行的 Syncthing 服务并从系统启动序列中移除它，这样在未来的系统启动时，Syncthing 将不会自动启动。
4. 如果确定不再需要这个服务，还可以删除服务文件：

```shell
sudo rm /etc/systemd/system/syncthing.service
```

5. 然后重新加载 systemd 配置以应用更改：

```shell
sudo systemctl daemon-reload
```

### ⑤、FreeFileSync 文件同步的使用

#### Ⅰ、介绍

1. FreeFileSync 是一款开源的文件同步软件，广泛用于备份和同步文件和文件夹。它支持多种操作系统，包括 Windows、macOS 和 Linux
2. 主要功能：
	1. 实时同步：通过 RealTimeSync 组件，用户可以实现文件的实时同步，这意味着任何文件的更改都会即时同步到目标位置。
	2. 批处理模式：用户可以创建 .ffs_batch 文件，这些文件包含同步任务的所有必要设置，可以通过命令行自动执行。
	3. 灵活的同步选项：支持镜像、更新和自定义同步，用户可以根据需要配置文件的复制和删除行为。
	4. 图形用户界面：提供直观的用户界面，使得文件同步的设置和执行变得简单易操作。
	5. 日志记录和错误报告：详细的日志帮助用户追踪同步任务的执行情况，及时发现和解决问题。
3. 使用场景：
	1. 数据备份：定期或实时备份重要数据到多个存储设备或云存储。
	2. 数据同步：在多个设备或位置之间同步数据，确保文件的一致性和可访问性。
	3. 自动化任务：通过批处理和命令行工具自动化常规的同步任务，节省时间和减少人为错误。
	4. FreeFileSync 是一个功能强大且灵活的工具，适用于个人用户和企业用户，帮助他们有效地管理文件同步和备份需求。
4. FreeFileSync 有四种同步模式：
	1. **双向模式**：源文件夹和目标文件夹内文件修改同步，修改任意文件夹内文件都影响到对方；
	2. **镜像模式**：源文件夹的文件修改会影响目标文件夹，目标文件夹的文件修改不会被保留且始终保持和源文件夹一致；
	3. **更新模式**：源文件夹的文件只会增量修改到目标文件夹，目标文件夹的修改可以保留且不影响源文件夹；
	4. **自定义模式**：自定义文件同步规则；
5. 使用的原因是 Syncthing 并不能实现同一个设备的不同目录（硬盘）之间同步文件，所以将 FreeFileSync 和 Syncthing 结合使用

#### Ⅱ、下载解压

1. 官网：https://freefilesync.org/download.php

![|675](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718092505.png)

2. 下载完成后，使用 tar 命令提取：

```shell
tar -xvf FreeFileSync_13.7_Linux.tar.gz
```

3. 会生成 `FreeFileSync_13.7_Install.run` 文件

#### Ⅲ、安装

1. 运行安装文件：

```shell
./FreeFileSync_13.7_Install.run
```

2. 输入 y 并按 ENTER 接受许可条款：

```shell
Accept the FreeFtlesync license terns? [y]es, [n]o, or [s]how: [y/n/s] y 
```

3. 设置项：
	1. 是否给所有用户安装
	2. 安装目录
	3. 是否创建快捷方式

```shell
FreeFilesync 13.7 Setup

1. Install for all users:    NO (current user only) 
2. Installation directory:   /home/yan/FreeFileSync 
3. Create desktop shortcuts: YES

Press a number [1-3] to change settings, 
ENTER to begin installation:
```

4. 设置项修改结果：

```shell
FreeFilesync 13. 7 Setup

1. Install for all users:    NO (current user only)
2. Installation directory:   /home/yan/apply/file/FreeFilesync 
3. Create desktop shortcuts: YES

Press a number [1-3] to change settings, 
ENTER to begin installation:
```

5. 按 ENTER 键继续安装：

```shell
-> Installing to: /home/yan/apply/file/FreeFileSync
-> New console command: freefilesync
-> Registering file extensions: *.ffs_gui, *.ffs_batch, *.ffs_real

All done!
           __     __
          /  \~~~/  \ 
    ,----(     ^^    )
   /      \__     __/
  /|         (\  |(
 ^ \   /___\  /\ |
    |__|   |__| "

Get the Donation Edition with bonus features and help keep FreeFileSync ad-free.
https://freefilesync.org/donate

yan@yan:~/apply/file/FreeFileSync$ 
```

6. 安装完成后，桌面上会多出来两个图标：

![](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718093931.png)

7. 绿色的 `FreeFileSync` 是 FreeFileSync 主程序
8. 红色的 `RealTimeSync` 是自动同步程序，启动后，若指定目录中的文件发生变化，则会执行对应脚本

#### Ⅳ、使用 FreeFileSync 同步文件

1. 点击绿色的 `FreeFileSync` 打开软件
2. FreeFileSync 的用户界面：
	1. 1：保存 / 加载配置
	2. 比较内容缩略图
	3. 比较文件差异按钮
	4. 文件比较设置
	5. 过滤器设置
	6. 文件同步设置
	7. 文件同步按钮
	8. 添加文件目录组
	9. 源文件目录
	10. 两侧互换按钮
	11. 目标文件目录
	12. 源文件目录与目标目录不同的文件列表
	13. 同步动作预览区域
	14. 目标文件与源文件不同的列表
	15. 同步动作统计

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718124000.png)

3. 打开过滤器，在排除项中加入以下内容：
	1. 因为是将 FreeFileSync 和 Syncthing 结合使用，所以同步的目录中有 Syncthing 创建的目录
	2. 这里是将 Syncthing 创建的目录排除掉

```shell
*/.stfolder*
*/.stfolder/*
```

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718125846.png)

4. 点击同步设置，改为镜像模式：
	1. 因为多端文件的同步使用的是 Syncthing，FreeFileSync 只是作为文件备份工具来使用，所以使用镜像模式
	2. 四种模式的区别请参照第一节

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718130803.png)

5. 关于上面的使用数据库文件来检测变化的作用：
	1. 当启用使用数据库文件的选项时，FreeFileSync 会创建一个数据库来记录文件和文件夹的状态信息。这些信息包括文件的大小、修改时间和其他元数据。通过这种方式，每次同步时 FreeFileSync 只需要比较当前文件状态与数据库中记录的状态，从而确定哪些文件发生了变化。这种方法的优势包括：
		1. 效率更高：比较过程只需对比数据库中的记录与当前状态，不需要对整个文件内容进行扫描，从而提高同步的效率。
		2. 减少资源消耗：减少了对磁盘的读写操作，尤其是在文件数量庞大的情况下。
		3. 改进的变化检测：能够更精确地识别出哪些文件确实发生了变化，即使文件修改时间没有更新。
	2. 如果不使用数据库文件，FreeFileSync 将直接比较源和目标文件夹中的文件。这通常涉及到比较文件的大小、修改时间等属性。这种方法的特点包括：
		1. 简单直接：不需要额外创建和维护数据库文件，操作更为直接。
		2. 可能的性能开销：在没有数据库辅助的情况下，每次同步可能需要更多的时间和计算资源，特别是文件数量多或文件大小大的情况下。
		3. 适用性：对于较小的或不经常变化的文件集，这种方法可能更加高效。
	3. 总的来说，选择使用数据库文件还是不使用，取决于具体需求、文件数量以及同步频率。使用数据库可以显著提高大规模文件同步的效率和准确性，但如果同步任务不频繁或文件数量较少，直接比较也是一个有效的选择。
6. 点击浏览可以选择同步的目录：
	1. 左边的目录是原始目录，右边的目录是目标目录
	2. 当左边的目录中的内容发生变化时，会将变化同步至右边的目录中
	3. 具体的同步细节再上面的同步设置中
	4. 可以选择多个目录，也可以一对多

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718131152.png)

7. 此时点击同步按钮即可开始同步

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718131527.png)

8. 点击保存可以将本次的设置保存下来，以便下次使用

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718131619.png)

#### Ⅴ、使用 RealTimeSync 自动同步文件

1. 点击绿色的 `FreeFileSync` 打开软件
2. 先选择刚才保存的配置，然后点击上方的另存为批处理作业

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718131908.png)

3. 可以选择以最小化运行以及忽略错误，点击另存为保存

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718132037.png)

4. 点击红色的 `RealTimeSync` 打开软件
5. 首先选择要监视变化的目录，一般和上面选择同步的原始目录相同
6. 然后填入检测到变化后要执行的命令行，此处填入 FreeFileSync 安装路径及程序，后面以刚才保存的批处理作业的路径为参数

```shell
/home/yan/apply/file/FreeFileSync/FreeFileSync /home/yan/apply/file/FreeFileSync/sava/SyncSettings.ffs_batch
```

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020240718132846.png)

7. 最后的选项运行命令之前最小的空闲时间（以秒计），表示如果监测到了目录中的内容发生了变化，延迟执行命令的时间
8. 点击开始，即可启动后台任务，当程序监测到了目录中的内容发生了变化，就会执行同步操作

#### Ⅵ、关闭 RealTimeSync 自动同步任务

1. 在命令行输入 `ps -ef | grep FreeFileSync` 命令查看 FreeFileSync 是否在后台运行：

```shell
ps -ef | grep FreeFileSync
```

```shell
yan@yan:~$ ps -ef|grep FreeFileSync
yan      2601322 2598642  0 13:22 ?        00:00:00 /home/yan/apply/file/FreeFileSync/RealTimeSync
yan      2601327 2601322  0 13:22 ?        00:00:00 /home/yan/apply/file/FreeFileSync/Bin/RealTimeSync_x86_64
yan      2601781 2591203  0 13:32 pts/4    00:00:00 grep --color=auto FreeFileSync

yan@yan:~$ 
```

2. 从输出来看确实是在后台运行
3. 根据进程号关闭进程

```shell
kill 2601322 2601327
```

4. 如果想要确保进程被强制终止，可以使用 kill -9 命令：

```shell
kill -9 2601322 2601327
```

### ⑥、`screen` 多重视窗管理程序

#### Ⅰ、介绍

1. `GNU Screen` 简称 `Screen` 或 `screen`，源自 GNU 计划，其官网：[GNU Screen](https://www.gnu.org/software/screen/)。
2. 初始版本早在1987年就发布，目前的最新稳定版本是：4.8.0（2020年2月5日）。所以，你现在使用的 screen 命令，其实三十年前就有人在使用了。
3. screen的功能大体有三个：
4. 会话恢复：只要 `screen` 本身没有终止，在其内部运行的会话都可以恢复。
	1. 这一点对于远程登录的用户特别有用：即使网络连接中断，用户也不会失去对已经打开的命令行会话的控制。只要再次登录到主机上执行 `screen -r `就可以恢复会话的运行。
	2. 同样在暂时离开的时候，也可以执行分离命令 `detach`，在保证里面的程序正常运行的情况下让 `screen` 挂起（切换到后台）。
5. 多窗口：在 `screen` 环境下，所有的会话都独立的运行，并拥有各自的编号、输入、输出和窗口缓存。用户可以通过快捷键在不同的窗口下切换，并可以自由的重定向各个窗口的输入和输出。
6. 会话共享：`screen` 可以让一个或多个用户从不同终端多次登录一个会话，并共享会话的所有特性（比如可以看到完全相同的输出）。它同时提供了窗口访问权限的机制，可以对窗口进行密码保护。

#### Ⅱ、安装 `screen`

1. 更新软件源

```shell
sudo apt update
```

2. 安装 screen

```shell
# CentOS
yum install screen

# Debian/Ubuntu
apt install screen
```

#### Ⅲ、状态介绍

1. 通常情况下，screen 创建的虚拟终端，有两个工作模式：
	1. `Attached`：表示当前 `screen` 正在作为主终端使用，为活跃状态。
	2. `Detached`：表示当前 `screen` 正在后台使用，为非激发状态。

```shell
steam@yan:~$ screen -ls
There are screens on:
        58311.PalWorld-2        (2024年01月29日 19时46分37秒)   (Attached)
        41007.PalWorld  (2024年01月25日 19时07分23秒)   (Attached)
        30419.tmodloader        (2024年01月21日 15时36分14秒)   (Detached)
        16466.7DaysServer       (2024年01月19日 21时37分45秒)   (Detached)
4 Sockets in /run/screen/S-steam.
steam@yan:~$ 
```

2. 通常情况下，不需要关注上面的状态。

#### Ⅳ、基础命令

##### （1）、帮助查询

1. screen 的帮助文档实在是过于详细，以至于查个命令，可能要查几分钟
2. 但是你可以直接使用帮助命令，查询自己需要的命令:

```shell
# 查询 screen 提示
screen -help
```

3. 通过这个命令，可以查询到大部常用命令。

```shell
steam@yan:~$ screen -help
Use: screen [-opts] [cmd [args]]
 or: screen -r [host.tty]

Options:
-4            Resolve hostnames only to IPv4 addresses.
-6            Resolve hostnames only to IPv6 addresses.
-a            Force all capabilities into each window's termcap.
-A -[r|R]     Adapt all windows to the new display width & height.
-c file       Read configuration file instead of '.screenrc'.
-d (-r)       Detach the elsewhere running screen (and reattach here).
-dmS name     Start as daemon: Screen session in detached mode.
-D (-r)       Detach and logout remote (and reattach here).
-D -RR        Do whatever is needed to get a screen session.
-e xy         Change command characters.
-f            Flow control on, -fn = off, -fa = auto.
-h lines      Set the size of the scrollback history buffer.
-i            Interrupt output sooner when flow control is on.
-l            Login mode on (update /var/run/utmp), -ln = off.
-ls [match]   or
-list         Do nothing, just list our SockDir [on possible matches].
-L            Turn on output logging.
-Logfile file Set logfile name.
-m            ignore $STY variable, do create a new screen session.
-O            Choose optimal output rather than exact vt100 emulation.
-p window     Preselect the named window if it exists.
-q            Quiet startup. Exits with non-zero return code if unsuccessful.
-Q            Commands will send the response to the stdout of the querying process.
-r [session]  Reattach to a detached screen process.
-R            Reattach if possible, otherwise start a new session.
-s shell      Shell to execute rather than $SHELL.
-S sockname   Name this session <pid>.sockname instead of <pid>.<tty>.<host>.
-t title      Set title. (window's name).
-T term       Use term as $TERM for windows, rather than "screen".
-U            Tell screen to use UTF-8 encoding.
-v            Print "Screen version 4.09.00 (GNU) 30-Jan-22".
-wipe [match] Do nothing, just clean up SockDir [on possible matches].
-x            Attach to a not detached screen. (Multi display mode).
-X            Execute <cmd> as a screen command in the specified session.
steam@yan:~$ 
```

##### （2）、终端列表

1. 怎么查看已经存在的 screen 终端呢？很简单，使用命令：

```shell
screen -ls
```

2. 即可查看已经创建（在后台运行的终端）：

```shell
steam@yan:~$ screen -ls
There are screens on:
        58311.PalWorld-2        (2024年01月29日 19时46分37秒)   (Detached)
        41007.PalWorld  (2024年01月25日 19时07分23秒)   (Detached)
        30419.tmodloader        (2024年01月21日 15时36分14秒)   (Detached)
        16466.7DaysServer       (2024年01月19日 21时37分45秒)   (Detached)
4 Sockets in /run/screen/S-steam.
steam@yan:~$
```

3. 如果你之前没有创建，那么是为空的：

```shell
yan@yan:~$ screen -ls
No Sockets found in /run/screen/S-yan.

yan@yan:~$ 
```

##### （3）、新建终端

1. 新建终端有三种方式：
	1. 输入 `screen` 回车，即可新建一个虚拟终端，但是这样的名称太乱
	2. 使用参数 `-S` 创建：`screen -S Hello`
	3. 使用参数 `-R` 创建：`screen -R Hello`
2. 三种创建方法比较：
	1. 使用 `-S` 创建和直接输入 `screen` 创建的虚拟终端，不会检录之前创建的 `screen`，也就是会创建同名的 `screen`
	2. 使用 `-R` 创建，如果之前有创建唯一一个同名的 `screen`，则直接进入之前创建的 `screen`
3. 创建好虚拟终端后，会新建一个空白的 Terminal，这个就是新的虚拟终端了
4. 运行你的程序，按 `Ctril + a`，再按 `d`，即可保持这个 `screen` 到后台并回到主终端

##### （4）、回到 `screen` 终端

1. 在主终端使用 `-R` 或者 `-r` 命令即可：

```shell
# 使用 screen -r 命令
screen -r [pid/name]
```

2. 其中：`pid/name`：为虚拟终端 PID 或 Name，可使用 `screen -ls` 查看；下面 `58311.PalWorld-2` 即为 `pid.name`

```shell
steam@yan:~$ screen -ls
There are screens on:
        58311.PalWorld-2        (2024年01月29日 19时46分37秒)   (Detached)
        41007.PalWorld  (2024年01月25日 19时07分23秒)   (Detached)
        30419.tmodloader        (2024年01月21日 15时36分14秒)   (Detached)
        16466.7DaysServer       (2024年01月19日 21时37分45秒)   (Detached)
4 Sockets in /run/screen/S-steam.
steam@yan:~$
```

3. 如果使用大写 的 `-R`，和 `-r` 类似，但是没有对应名称的 PID 或者 Name 时，会自动创建新的虚拟终端。

##### （5）、清除终端

1. 有时候，我们的进程已经“守护”完毕，不需要这个虚拟终端了，也就是需要释放资源，如何操作呢？
2. 比较推荐的方法，是进入对应虚拟终端，然后输入：

```shell
# 退出终端
exit
```

3. 之后，就会回到主终端
4. 当然，如果确定 screen 中的程序已经停止运行了，也可以在主终端内，使用命令释放：

```shell
# 使用-R/-r/-S均可
screen -S [pid/Name] -X quit
```

##### （6）、不进入 `screen` 终端的情况下执行命令

1. 使用 `stuff` 指令向指定 `screen` 终端发送字符：

```shell
#!/bin/bash

# screen 会话名称，每个会话中可能有多个窗口
screen_name="PalWorld-2"
# 脚本所在路径
path="/home/steam/game/PalServer"

# 模拟按下 Ctrl + C 组合键，防止服务器正在运行；等待 10 秒
# -x：附加到指定的会话。
# -S $screen_name：指定要操作的会话名称。
# -p 0：选择会话中的窗口编号，这里是选择窗口编号为 0 的窗口。
# -X stuff：在选定的窗口中发送字符。
screen -x -S $screen_name -p 0 -X stuff $'\x03'
sleep 10
screen -x -S $screen_name -p 0 -X stuff $'\x03'
sleep 5

# 发送启动 PalServer 命令，包括运行参数，将命令发送到会话中，并模拟按下回车键。同时等待 20 秒，确保 PalServer 启动完成
screen -x -S $screen_name -p 0 -X stuff "$path/PalServer.sh -useperfthreads -NoAsyncLoadingThread -UseMultithreadForDSD\r"
sleep 20

# 分离会话，模拟按下 Ctrl + C + D 组合键；等待 2 秒
screen -x -S $screen_name -p 0 -X stuff $'\x01'
screen -x -S $screen_name -p 0 -X stuff "D"
sleep 2

# 向 yuehai_server.log 文件中追加日志
echo "$(date)：帕鲁服务器 1 已启动" >> $path/yuehai_server.log
```

2. 具体参数的含义如下：
	1. `-x`：附加到指定的会话。
	2. `-S $screen_name`：指定要操作的会话名称。
	3. `-p 0`：选择会话中的窗口编号，这里是选择窗口编号为 0 的窗口；可以不加，默认选择会话的第一个窗口
	4. `-X stuff`：在选定的窗口中发送字符。

### ⑦、使用 mailutils 发送邮件

#### Ⅰ、安装 mailutils

1. 查询是否已经安装：

```shell
mail --version
```

2. 更新软件源：

```shell
sudo apt update
```

3. 安装 mailutils

```shell
sudo apt install mailutils
```

4. 再次查询是否已经安装：

```shell
mail --version
```

```shell
yan@yan:~$ mail --version
mail (GNU Mailutils) 3.14
Copyright (C) 2007-2022 Free Software Foundation, inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

yan@yan:~$ 
```

#### Ⅱ、发送邮件

1. 使用 `mail` 命令发送邮件：

```shell
echo "测试邮件正文" | mail -s "测试邮件主题" -r yan@yue-hai.top 770717410@qq.com
```

2. `"测试邮件正文"`：邮件正文
3. `mail`：用于发送邮件
4. `-s "测试邮件主题"`：指定邮件的主题（标题）为：测试邮件主题
5. `-r yan@yue-hai.top`：指定邮件的发件人地址为 `yan@yue-hai.top`
6. `770717410@qq.com`：指定邮件的收件人地址为 `770717410@qq.com`

### ⑧、

### ⑨、

## 8、指令使用

### ①、使用 sftp 命令从 linux 服务器下载文件

#### Ⅰ、sftp 介绍

1. SFTP（SSH File Transfer Protocol）是一种安全的文件传输协议，它在 SSH 协议的基础上提供文件访问、文件传输和文件管理功能
2. 与 FTP 相比，SFTP 提供了加密的网络通信，保证数据在传输过程中的安全性

#### Ⅱ、启动一个 SFTP 会话

```shell
sftp -oPort=端口号 username@hostname
```

1. `username` 是远程服务器上的用户名
2. `hostname` 是服务器的地址
3. 默认使用 ssh 的端口号，即 `22`；如果服务器使用了非标凈端口，可以使用 `-oPort=端口号` 来指定
4. 回车后会要求输入密码
5. 退出 SFTP 会话：`exit` 或 `quit`

```shell
exit
```

#### Ⅲ、常用指令

##### （1）、控制远程文件指令

1. `pwd`：查看当前所在的远程目录路径

```shell
sftp> pwd
Remote working directory: /home/yan/桌面

sftp> 
```

2. `ls` 或 `dir`：列出远程目录的内容。

```shell
sftp> ls
 \214Wk\250U                               100%   24MB  21.6KB/s   19:09    
IDE                      Idea                     aiXcoder                 
apply                    authlib-injector.log     output.pcap              
snap                     下载                   公共的                
图片                   文档                   桌面                   
模板                   视频                   音乐                   
sftp>
```

3. `cd`：改变远程目录。

```shell
sftp> cd 桌面
\300\306Wk\250U                              0%    0   -101.-1KB/s   -4:-5 E

sftp> pwd
Remote working directory: /home/yan/桌面

sftp> 
```

4. `mkdir`：在远程服务器上创建目录。

```shell
mkdir directory_name
```

5. `rmdir`：删除远程服务器上的目录。

```shell
rmdir directory_name
```

6. `rm`：删除远程服务器上的文件。

```shell
rm file_name
```

7. `chmod`：改变远程文件或目录的权限。

```shell
chmod 0755 file_name
```

##### （2）、控制本地文件指令

1. `lpwd`：查看当前所在的本地目录路径

```shell
sftp> lpwd
Local working directory: /home/yan/apply

sftp> 
```

2. `lls`：列出本地目录的内容。

```shell
sftp> lls
n2n  n2n-edge-query  n2n-edge-query-check  v2ray
sftp> 
```

3. `lcd`：改变本地目录；下载时默认下载的目录

```shell
sftp> lcd ~/download

sftp> lpwd
Local working directory: /home/yan/download

sftp> 
```

##### （3）、下载上传文件指令

1. `get`：下载文件：从远程机器到本地机器
	1. 如果未指定本地文件名，文件将以远程文件同名保存到当前本地目录
	2. 若是下载的文件路径中含有空格，需用引号包裹起来

```shell
get "/home/yan/桌面/音乐/【纯音乐】/墨明棋妙 - 皓水莫负.flac" [local-file]
```

2. `put`：上传文件：从本地机器到远程机器
	1. 如果未指定远程文件名，文件将以本地文件同名保存到当前远程目录。
	2. 若是上传的文件路径中含有空格，需用引号包裹起来

```shell
put "墨明棋妙 - 皓水莫负.flac" [remote-file]
```

3. `mget`：下载多个文件。

```shell
# 下载当前目录下的所有 flac 文件
mget *.flac

# 下载指定目录下的所有文件
mget /home/yan/桌面/音乐/【纯音乐】/*
```

4. `mput`：上传多个文件。

```shell
# 上传当前目录下的所有文件
mput *

# 上传指定目录下的所有 flac 文件
mput /home/yan/桌面/音乐/【纯音乐】/*.flac
```

### ②、实时进程监控工具 top

#### Ⅰ、启动 `top`

1. 只需在终端中输入 `top`，按 Enter 键即可启动

#### Ⅱ、输出信息介绍

##### （0）、例子

```shell
yan@yan:~/apply/tools/yuehai-tool$ top
top - 08:40:54 up 14:54,  2 users,  load average: 0.01, 0.04, 0.04
任务: 377 total,   1 running, 376 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni, 99.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
MiB Mem :  4.5/29811.0  [|||                                                                           ]
MiB Swap:  0.0/2048.0   [                                                                              ]

 进程号 USER      PR  NI    VIRT    RES    SHR    %CPU  %MEM     TIME+ COMMAND                           
    851 root      20   0 2170060  44432  31232 S   0.7   0.1   2:22.64 containerd                        
  11658 yan       20   0   22076   4352   3328 R   0.3   0.0   0:01.29 top                               
      1 root      20   0  166956  11644   8188 S   0.0   0.0   0:31.43 systemd                           
      2 root      20   0       0      0      0 S   0.0   0.0   0:00.03 kthreadd                          
      3 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 rcu_gp                            
      4 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 rcu_par_gp                        
      5 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 slub_flushwq                      
      6 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 netns                             
      8 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker/0:0H-events_highpri       
     10 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 mm_percpu_wq                      
     11 root      20   0       0      0      0 I   0.0   0.0   0:00.00 rcu_tasks_kthread                 
     12 root      20   0       0      0      0 I   0.0   0.0   0:00.00 rcu_tasks_rude_kthread            
     13 root      20   0       0      0      0 I   0.0   0.0   0:00.00 rcu_tasks_trace_kthread           
     14 root      20   0       0      0      0 S   0.0   0.0   0:00.47 ksoftirqd/0                       
     15 root      20   0       0      0      0 I   0.0   0.0   0:15.45 rcu_preempt                       
     16 root      rt   0       0      0      0 S   0.0   0.0   0:00.30 migration/0                       
     17 root     -51   0       0      0      0 S   0.0   0.0   0:00.00 idle_inject/0                     
     19 root      20   0       0      0      0 S   0.0   0.0   0:00.00 cpuhp/0                           
     20 root      20   0       0      0      0 S   0.0   0.0   0:00.00 cpuhp/1                           
     21 root     -51   0       0      0      0 S   0.0   0.0   0:00.00 idle_inject/1                     
     22 root      rt   0       0      0      0 S   0.0   0.0   0:00.55 migration/1                       
     23 root      20   0       0      0      0 S   0.0   0.0   0:00.07 ksoftirqd/1                       
     25 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker/1:0H-events_highpri       
     26 root      20   0       0      0      0 S   0.0   0.0   0:00.00 cpuhp/2                           
     27 root     -51   0       0      0      0 S   0.0   0.0   0:00.00 idle_inject/2                     
     28 root      rt   0       0      0      0 S   0.0   0.0   0:00.50 migration/2                       
     29 root      20   0       0      0      0 S   0.0   0.0   0:01.15 ksoftirqd/2                       
     31 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker/2:0H-events_highpri       
     32 root      20   0       0      0      0 S   0.0   0.0   0:00.00 cpuhp/3                           
```

##### （1）、top 命令的输出头部

```shell
top - 08:40:54 up 14:54,  2 users,  load average: 0.01, 0.04, 0.04
```

1. `08:40:54 up 14:54`：这表示系统在 08:40:54 运行了 top 命令，且系统已运行了 14 小时 54 分钟
2. `2 users`：系统上有 2 个用户登录
3. `load average: 0.01, 0.04, 0.04`：这些数字分别代表过去 1 分钟、5 分钟和 15 分钟的平均负载。负载平均值越低，表明系统越空闲

##### （2）、任务（任务）

```shell
任务: 377 total,   1 running, 376 sleeping,   0 stopped,   0 zombie
```

1. `377 total`：系统总共有 377 个进程
2. `1 running`：有 1 个进程正在运行
3. `376 sleeping`：有 376 个进程处于休眠状态
4. `0 stopped`：没有进程被停止
5. `0 zombie`：没有僵尸进程

##### （3）、CPU 使用情况（%Cpu(s)）

```shell
%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni, 99.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
```

1. `0.0 us`：用户空间占用的 CPU 百分比
2. `0.0 sy`：内核空间占用的 CPU 百分比
3. `0.0 ni`：改变过优先级的进程占用的 CPU 百分比
4. `99.9 id`：空闲的 CPU 百分比
5. `0.0 wa`：等待输入输出的 CPU 百分比
6. `0.0 hi`：处理硬件中断的 CPU 百分比
7. `0.0 si`：处理软件中断的 CPU 百分比
8. `0.0 st`：被偷走的时间（在虚拟环境中被用于服务其他虚拟机的时间）

##### （4）、内存使用情况

```shell
MiB Mem :  4.5/29811.0  [|||                                                                           ]
MiB Swap:  0.0/2048.0   [                                                                              ]
```

1. `MiB Mem : 4.5/29811.0`：从总共 29811 MiB 内存中，有 4.5 MiB 正在使用
2. `MiB Swap: 0.0/2048.0`：从总共 2048 MiB 交换空间中，有 0.0 MiB 正在使用

##### （5）、进程列表

```shell
 进程号 USER      PR  NI    VIRT    RES    SHR    %CPU  %MEM     TIME+ COMMAND                           
    851 root      20   0 2170060  44432  31232 S   0.7   0.1   2:22.64 containerd                        
  11658 yan       20   0   22076   4352   3328 R   0.3   0.0   0:01.29 top                               
      1 root      20   0  166956  11644   8188 S   0.0   0.0   0:31.43 systemd                           
      2 root      20   0       0      0      0 S   0.0   0.0   0:00.03 kthreadd   
```

1. `进程号`：进程的唯一标识符
2. `USER`：运行该进程的用户
3. `PR`：进程优先级
4. `NI`：进程的 nice 值，影响进程的优先级
5. `VIRT`：进程使用的虚拟内存总量
6. `RES`：进程使用的、未被换出的物理内存大小
7. `SHR`：共享内存大小
8. `%CPU`：进程占用的 CPU 百分比
9. `%MEM`：进程占用的内存百分比
10. `TIME+`：进程使用 CPU 的总时间
11. `COMMAND`：正在执行的命令名称
12. 示例进程：
	1. containerd 容器运行时，使用了 0.7% 的 CPU 和 0.1% 的内存
	2. top: top 命令本身，占用 0.3% 的 CPU

#### Ⅲ、排序进程

1. 在 `top` 界面中，可以按特定的列进行排序，如 CPU 使用率或内存使用：
2. 按 `%CPU` 排序：按 `P`，即 `Ctrl + p`
3. 按内存使用排序：按 `M`，即 `Ctrl + m`

#### Ⅳ、杀死进程

1. 如果需要结束某个进程，可以在 `top` 中直接操作：
2. 按 `k`，然后输入想要结束的进程的 PID（进程ID），并确认。

#### Ⅴ、搜索进程

1. 可以通过进程名搜索特定进程：
2. 按 `o`（小写字母 O），然后输入 `COMMAND=<进程名>`，如 `COMMAND=bash`

#### Ⅵ、改变更新间隔

1. 默认情况下，`top` 每几秒更新一次数据，可以调整这个间隔：
2. 在运行 `top` 时，可以按 `d`，然后输入想要的更新频率（秒数）。

#### Ⅶ、显示或隐藏特定列

1. `top` 可以定制显示或隐藏的信息：
2. 按 `f` 进入字段管理界面，使用方向键选择要显示或隐藏的字段，按 `d` 或 `s` 来选择。

#### Ⅷ、切换显示模式

1. 可以在不同的显示模式之间切换，以便更好地查看信息：
2. 按 `1` 可以查看每个 CPU 的详细利用率。
3. 按 `V` （即 `Ctrl + v`）可以按树状结构显示进程。

#### Ⅸ、退出 `top`

1. 简单地按 `q`（退出键）即可退出 `top` 界面。

### ③、套接字信息检索工具 `ss`

> ss (socket statistics) 命令是一个非常强大的工具，用于检索有关 Linux 中的套接字的信息。
> 
> 它可以显示类似于 netstat 的信息，但比 netstat 更快，因为它直接从内核空间获取数据，而不需要读取和解析 /proc 目录

#### Ⅰ、基本选项

1. - `-t`：显示 TCP 套接字
2. `-u`：显示 UDP 套接字
3. `-l`：显示处于监听状态的套接字
4. `-a`：显示所有套接字（默认只显示已建立的连接）
5. `-n`：以数字形式显示地址和端口号，不尝试解析域名、服务等
6. `-p`：显示使用套接字的进程 ID 和程序名称
7. `-s`：输出套接字使用概况统计。

#### Ⅱ、高级选项

1. `-e`：显示扩展信息，这包括时间戳、内存、selinux 等
2. `-m`：显示套接字的内存使用情况
3. `-o`：显示计时器信息
4. `-4`：仅显示 IPv4 的套接字
5. `-6`：仅显示 IPv6 的套接字
6. `-d`：仅显示处于断开状态的套接字

#### Ⅲ、过滤和查询

> `ss` 命令也支持使用过滤表达式来查询特定的连接或套接字。例如：

1. 显示所有到达或从指定 IP 发出的 TCP 连接：

```bash
ss state all dport = :http
```

2. 显示所有监听端口和对应进程：

```bash
ss -ltup
```

3. 显示所有与特定远程地址和端口建立的连接：
```bash
ss dst 192.168.1.1:ssh
```

#### Ⅳ、使用实例

1. 列出所有活动的 TCP 连接：

```bash
ss -t -a
```

2. 查找使用特定端口的应用：

```bash
ss -ltnp | grep ':80'
```

3. 显示特定网络接口的统计数据：

```bash
ss -i src 192.168.1.5
```

4. 列出所有监听的套接字以及它们的进程名：

```bash
ss -ltup
```

5. 筛选出所有与端口 10000 相关的 TCP 连接，并显示相关信息，如使用该端口的进程和连接的 IP 地址

```shell
ss -ntp | grep 10000
```

### ④、处理压缩文件和目录常用的命令

#### Ⅰ、tar 命令

1. tar（tape archive）命令是用于创建、维护、修改以及提取文件的工具，它可以处理 `.tar` 文件（归档），并且可以与 gzip 或 bzip2 等压缩程序结合使用来创建 `.tar.gz` 或 `.tar.bz2` 文件。
2. 常用参数：
	1. `-c`：创建一个新的归档文件。
	2. `-x`：从归档文件中提取文件。
	3. `-v`：显示操作过程（verbose模式）。
	4. `-f`：指定归档文件的名称。
	5. `-z`：使用 gzip 压缩或解压。
	6. `-j`：使用 bzip2 压缩或解压。
	7. `-t`：列出归档内容而不解压。
	8. `-C`：在解压时切换到指定目录。
3. 示例：
4. 创建归档文件：

```shell
tar -cvf 归档文件名.tar 想要打包的目录或文件名/
```

5. 创建并 gzip 压缩：

```shell
tar -czvf 归档文件名.tar.gz 想要打包的目录或文件名/
```

6. 解压 tar 文件：

```shell
tar -xvf 归档文件名.tar 想要提取的目录或文件名/
```

7. 解压并 gzip 解压：

```shell
tar -xzvf 归档文件名.tar.gz 想要提取的目录或文件名/
```

#### Ⅱ、gzip 和 gunzip 命令

1. gzip 用于压缩文件，而 gunzip 用于解压文件。
2. 常用参数：
	1. `-d`：gzip 使用此参数可以解压文件，等同于gunzip。
	2. `-k`：保留原文件。
	3. `-l`：列出压缩文件的信息。
	4. `-r`：递归处理所有文件。
3. 示例：
4. 压缩文件：

```shell
gzip filename
```

5. 解压文件：

```shell
gunzip filename.gz

# 或
gzip -d filename.gz
```

6. gzip 命令本身并不支持直接压缩目录，因为它只能压缩单个文件。如果想压缩一个目录，通常的做法是先使用 tar 命令将目录打包成一个单一的文件，然后使用 gzip 来压缩这个文件

```shell
# 打包并压缩
tar -czvf 归档文件名.tar 想要打包的目录或文件名/
```

#### Ⅲ、zip 和 unzip 命令

1. zip 是另一种常用的压缩工具，用于创建 `.zip` 文件。unzip 用于解压这些文件。
2. 常用参数：
	1. `-r`：递归地将目录及其内容添加到 zip 文件中。
	2. `-l`：列出 zip 归档的内容。
	3. `-u`：更新现有的 zip 归档。
	4. `-d`：指定解压目录。
3. 示例：
4. 压缩目录：

```shell
zip -r 归档文件名.zip 想要打包的目录或文件名/
```

5. 解压文件：

```shell
unzip 归档文件名.zip 想要解压到的目录/
```

### ⑤、

### ⑥、

### ⑦、

### ⑧、

### ⑨、

## 9、

# 四、AMD 

## 1、去除或恢复 AMD 显卡的右键菜单的方法

1. amd 显卡驱动安装完之后，在资源管理器右键会显示 amd 的菜单：

![|481](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023093010.png)

2. 去除方式：
3. `win + r` ，弹出运行窗口，输入：`regedit.exe`，打开注册表

![|750](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023093512.png)

4. 在地址栏输入：`计算机\HKEY_CLASSES_ROOT\Directory\background\shellex\ContextMenuHandlers\ACE`，点击进入 `ACE`

![|750](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023093748.png)

5. 删除 `ACE` 下的这个数值文件即可

![|700](https://www.yue-hai.top:10300/file/downloadPublicFile?basePathType=takeDown&subPath=%2F%E5%85%B6%E4%BB%96%2Fattachments%2FPasted%20image%2020231023093902.png)

## 2、

## 3、

# 五、键盘

## 1、阿米诺键盘

### ①、键盘带背光灯可以调节两个模式 

#### Ⅰ、常亮模式

1. `Fn + 方向 ↑ 键`
2. `FN + 方向 ↓ 键`（樱桃轴可调节至关闭）

#### Ⅱ、呼吸灯模式

1. `Fn + 方向 →`
2. 静电容 V2 关灯：`FN + X`

### ②、开关机

1. 开机：在未连接数据线的情况下，按 `Fn + Insert`，长按 5 秒开机 
2. 关机：在未连接数据线的情况下，按 `Fn + Insert`，长按 5 秒关机

### ③、复位

1. 先按住 `FN` 不放，再按住 `ESC` 键 4 秒左右，大小写键的灯会闪三下
2. 上面不起作用的情况下：先按住左 `WIN` 不放，再按住 `ESC` 键 4 秒左右，大小写键的灯会闪三下

### ④、切换蓝牙

1. fn ＋ f1 切换到蓝牙 1
2. fn ＋ f2 切换到蓝牙 2
3. 长按：清除配对信息并切换

# 六、

# 七、

# 八、

# 九、

# 十、

# 十一、

# 十二、

# 十三、

# 十四

# 十五、

# 十六、

# 十七、

# 十八、

# 十九、

# 二十、

## 1、

## 2、

## 3、

## 4、

## 5、

## 6、

## 7、

## 8、

## 9、

---

### ①、

### ②、

### ③、

### ④、

### ⑤、

### ⑥、

### ⑦、

### ⑧、

### ⑨、

### ⑩、

### ⑪、⑫、⑬、⑭、⑮、⑯、⑰、⑱、⑲、⑳

### ㉑、㉒、㉓、㉔、㉕、㉖、㉗、㉘、㉙、㉚

### ㉛、㉜、㉝、㉞、㉟、㊱、㊲、㊳、㊴、㊵

### ㊶、㊷、㊸、㊹、㊺、㊻、㊼、㊽、㊾、㊿

#### Ⅰ、

#### Ⅱ、

#### Ⅲ、

#### Ⅳ、

#### Ⅴ、

#### Ⅵ、

#### Ⅶ、

#### Ⅷ、

#### Ⅸ、

#### Ⅹ、`